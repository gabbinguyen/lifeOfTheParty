{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { merge, extend, isNullOrUndefined, setValue, getValue } from '@syncfusion/ej2-base';\nimport { DataUtil } from './util';\nimport { Query, Predicate } from './query';\nvar consts = {\n  GroupGuid: '{271bbba0-1ee7}'\n};\n/**\n * Adaptors are specific data source type aware interfaces that are used by DataManager to communicate with DataSource.\n * This is the base adaptor class that other adaptors can extend.\n * @hidden\n */\n\nvar Adaptor =\n/** @class */\nfunction () {\n  /**\n   * Constructor for Adaptor class\n   * @param  {DataOptions} ds?\n   * @hidden\n   * @returns aggregates\n   */\n  function Adaptor(ds) {\n    // common options for all the adaptors \n    this.options = {\n      from: 'table',\n      requestType: 'json',\n      sortBy: 'sorted',\n      select: 'select',\n      skip: 'skip',\n      group: 'group',\n      take: 'take',\n      search: 'search',\n      count: 'requiresCounts',\n      where: 'where',\n      aggregates: 'aggregates',\n      expand: 'expand'\n    };\n    /**\n     * Specifies the type of adaptor.\n     * @default Adaptor\n     */\n\n    this.type = Adaptor;\n    this.dataSource = ds;\n    this.pvt = {};\n  }\n  /**\n   * Returns the data from the query processing.\n   * @param  {Object} data\n   * @param  {DataOptions} ds?\n   * @param  {Query} query?\n   * @param  {XMLHttpRequest} xhr?\n   * @returns Object\n   */\n\n\n  Adaptor.prototype.processResponse = function (data, ds, query, xhr) {\n    return data;\n  };\n\n  return Adaptor;\n}();\n\nexport { Adaptor };\n/**\n * JsonAdaptor is used to process JSON data. It contains methods to process the given JSON data based on the queries.\n * @hidden\n */\n\nvar JsonAdaptor =\n/** @class */\nfunction (_super) {\n  __extends(JsonAdaptor, _super);\n\n  function JsonAdaptor() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  /**\n   * Process the JSON data based on the provided queries.\n   * @param  {DataManager} dataManager\n   * @param  {Query} query\n   * @returns Object\n   */\n\n\n  JsonAdaptor.prototype.processQuery = function (dataManager, query) {\n    var result = dataManager.dataSource.json.slice(0);\n    var count = result.length;\n    var countFlg = true;\n    var ret;\n    var key;\n    var lazyLoad = {};\n    var keyCount = 0;\n    var group = [];\n    var page;\n\n    for (var i = 0; i < query.lazyLoad.length; i++) {\n      keyCount++;\n      lazyLoad[query.lazyLoad[i].key] = query.lazyLoad[i].value;\n    }\n\n    var agg = {};\n\n    for (var i = 0; i < query.queries.length; i++) {\n      key = query.queries[i];\n\n      if ((key.fn === 'onPage' || key.fn === 'onGroup') && query.lazyLoad.length) {\n        if (key.fn === 'onGroup') {\n          group.push(key.e);\n        }\n\n        if (key.fn === 'onPage') {\n          page = key.e;\n        }\n\n        continue;\n      }\n\n      ret = this[key.fn].call(this, result, key.e, query);\n\n      if (key.fn === 'onAggregates') {\n        agg[key.e.field + ' - ' + key.e.type] = ret;\n      } else {\n        result = ret !== undefined ? ret : result;\n      }\n\n      if (key.fn === 'onPage' || key.fn === 'onSkip' || key.fn === 'onTake' || key.fn === 'onRange') {\n        countFlg = false;\n      }\n\n      if (countFlg) {\n        count = result.length;\n      }\n    }\n\n    if (keyCount) {\n      var args = {\n        query: query,\n        lazyLoad: lazyLoad,\n        result: result,\n        group: group,\n        page: page\n      };\n      var lazyLoadData = this.lazyLoadGroup(args);\n      result = lazyLoadData.result;\n      count = lazyLoadData.count;\n    }\n\n    if (query.isCountRequired) {\n      result = {\n        result: result,\n        count: count,\n        aggregates: agg\n      };\n    }\n\n    return result;\n  };\n  /**\n   * Perform lazy load grouping in JSON array based on the given query and lazy load details.\n   * @param  {LazyLoadGroupArgs} args\n   */\n\n\n  JsonAdaptor.prototype.lazyLoadGroup = function (args) {\n    var count = 0;\n    var agg = this.getAggregate(args.query);\n    var result = args.result;\n\n    if (!isNullOrUndefined(args.lazyLoad.onDemandGroupInfo)) {\n      var req = args.lazyLoad.onDemandGroupInfo;\n\n      for (var i = req.where.length - 1; i >= 0; i--) {\n        result = this.onWhere(result, req.where[i]);\n      }\n\n      if (args.group.length !== req.level) {\n        var field = args.group[req.level].fieldName;\n        result = DataUtil.group(result, field, agg, null, null, args.group[0].comparer, true);\n      }\n\n      count = result.length;\n      var data = result;\n      result = result.slice(req.skip);\n      result = result.slice(0, req.take);\n\n      if (args.group.length !== req.level) {\n        this.formGroupResult(result, data);\n      }\n    } else {\n      var field = args.group[0].fieldName;\n      result = DataUtil.group(result, field, agg, null, null, args.group[0].comparer, true);\n      count = result.length;\n      var data = result;\n\n      if (args.page) {\n        result = this.onPage(result, args.page, args.query);\n      }\n\n      this.formGroupResult(result, data);\n    }\n\n    return {\n      result: result,\n      count: count\n    };\n  };\n\n  JsonAdaptor.prototype.formGroupResult = function (result, data) {\n    if (result.length && data.length) {\n      var uid = 'GroupGuid';\n      var childLevel = 'childLevels';\n      var level = 'level';\n      var records = 'records';\n      result[uid] = data[uid];\n      result[childLevel] = data[childLevel];\n      result[level] = data[level];\n      result[records] = data[records];\n    }\n\n    return result;\n  };\n  /**\n   * Separate the aggregate query from the given queries\n   * @param  {Query} query\n   */\n\n\n  JsonAdaptor.prototype.getAggregate = function (query) {\n    var aggQuery = Query.filterQueries(query.queries, 'onAggregates');\n    var agg = [];\n\n    if (aggQuery.length) {\n      var tmp = void 0;\n\n      for (var i = 0; i < aggQuery.length; i++) {\n        tmp = aggQuery[i].e;\n        agg.push({\n          type: tmp.type,\n          field: DataUtil.getValue(tmp.field, query)\n        });\n      }\n    }\n\n    return agg;\n  };\n  /**\n   * Performs batch update in the JSON array which add, remove and update records.\n   * @param  {DataManager} dm\n   * @param  {CrudOptions} changes\n   * @param  {RemoteArgs} e\n   */\n\n\n  JsonAdaptor.prototype.batchRequest = function (dm, changes, e) {\n    var i;\n    var deletedRecordsLen = changes.deletedRecords.length;\n\n    for (i = 0; i < changes.addedRecords.length; i++) {\n      this.insert(dm, changes.addedRecords[i]);\n    }\n\n    for (i = 0; i < changes.changedRecords.length; i++) {\n      this.update(dm, e.key, changes.changedRecords[i]);\n    }\n\n    for (i = 0; i < deletedRecordsLen; i++) {\n      this.remove(dm, e.key, changes.deletedRecords[i]);\n    }\n\n    return changes;\n  };\n  /**\n   * Performs filter operation with the given data and where query.\n   * @param  {Object[]} ds\n   * @param  {{validate:Function}} e\n   */\n\n\n  JsonAdaptor.prototype.onWhere = function (ds, e) {\n    if (!ds || !ds.length) {\n      return ds;\n    }\n\n    return ds.filter(function (obj) {\n      if (e) {\n        return e.validate(obj);\n      }\n    });\n  };\n  /**\n   * Returns aggregate function based on the aggregate type.\n   * @param  {Object[]} ds\n   * @param  {{field:string} e\n   * @param  {string}} type\n   */\n\n\n  JsonAdaptor.prototype.onAggregates = function (ds, e) {\n    var fn = DataUtil.aggregates[e.type];\n\n    if (!ds || !fn || ds.length === 0) {\n      return null;\n    }\n\n    return fn(ds, e.field);\n  };\n  /**\n   * Performs search operation based on the given query.\n   * @param  {Object[]} ds\n   * @param  {QueryOptions} e\n   */\n\n\n  JsonAdaptor.prototype.onSearch = function (ds, e) {\n    if (!ds || !ds.length) {\n      return ds;\n    }\n\n    if (e.fieldNames.length === 0) {\n      DataUtil.getFieldList(ds[0], e.fieldNames);\n    }\n\n    return ds.filter(function (obj) {\n      for (var j = 0; j < e.fieldNames.length; j++) {\n        if (e.comparer.call(obj, DataUtil.getObject(e.fieldNames[j], obj), e.searchKey, e.ignoreCase, e.ignoreAccent)) {\n          return true;\n        }\n      }\n\n      return false;\n    });\n  };\n  /**\n   * Sort the data with given direction and field.\n   * @param  {Object[]} ds\n   * @param  {{comparer:(a:Object} e\n   * @param  {Object} b\n   */\n\n\n  JsonAdaptor.prototype.onSortBy = function (ds, e, query) {\n    if (!ds || !ds.length) {\n      return ds;\n    }\n\n    var fnCompare;\n    var field = DataUtil.getValue(e.fieldName, query);\n\n    if (!field) {\n      return ds.sort(e.comparer);\n    }\n\n    if (field instanceof Array) {\n      field = field.slice(0);\n\n      for (var i = field.length - 1; i >= 0; i--) {\n        if (!field[i]) {\n          continue;\n        }\n\n        fnCompare = e.comparer;\n\n        if (DataUtil.endsWith(field[i], ' desc')) {\n          fnCompare = DataUtil.fnSort('descending');\n          field[i] = field[i].replace(' desc', '');\n        }\n\n        ds = DataUtil.sort(ds, field[i], fnCompare);\n      }\n\n      return ds;\n    }\n\n    return DataUtil.sort(ds, field, e.comparer);\n  };\n  /**\n   * Group the data based on the given query.\n   * @param  {Object[]} ds\n   * @param  {QueryOptions} e\n   * @param  {Query} query\n   */\n\n\n  JsonAdaptor.prototype.onGroup = function (ds, e, query) {\n    if (!ds || !ds.length) {\n      return ds;\n    }\n\n    var agg = this.getAggregate(query);\n    return DataUtil.group(ds, DataUtil.getValue(e.fieldName, query), agg, null, null, e.comparer);\n  };\n  /**\n   * Retrieves records based on the given page index and size.\n   * @param  {Object[]} ds\n   * @param  {{pageSize:number} e\n   * @param  {number}} pageIndex\n   * @param  {Query} query\n   */\n\n\n  JsonAdaptor.prototype.onPage = function (ds, e, query) {\n    var size = DataUtil.getValue(e.pageSize, query);\n    var start = (DataUtil.getValue(e.pageIndex, query) - 1) * size;\n    var end = start + size;\n\n    if (!ds || !ds.length) {\n      return ds;\n    }\n\n    return ds.slice(start, end);\n  };\n  /**\n   * Retrieves records based on the given start and end index from query.\n   * @param  {Object[]} ds\n   * @param  {{start:number} e\n   * @param  {number}} end\n   */\n\n\n  JsonAdaptor.prototype.onRange = function (ds, e) {\n    if (!ds || !ds.length) {\n      return ds;\n    }\n\n    return ds.slice(DataUtil.getValue(e.start), DataUtil.getValue(e.end));\n  };\n  /**\n   * Picks the given count of records from the top of the datasource.\n   * @param  {Object[]} ds\n   * @param  {{nos:number}} e\n   */\n\n\n  JsonAdaptor.prototype.onTake = function (ds, e) {\n    if (!ds || !ds.length) {\n      return ds;\n    }\n\n    return ds.slice(0, DataUtil.getValue(e.nos));\n  };\n  /**\n   * Skips the given count of records from the data source.\n   * @param  {Object[]} ds\n   * @param  {{nos:number}} e\n   */\n\n\n  JsonAdaptor.prototype.onSkip = function (ds, e) {\n    if (!ds || !ds.length) {\n      return ds;\n    }\n\n    return ds.slice(DataUtil.getValue(e.nos));\n  };\n  /**\n   * Selects specified columns from the data source.\n   * @param  {Object[]} ds\n   * @param  {{fieldNames:string}} e\n   */\n\n\n  JsonAdaptor.prototype.onSelect = function (ds, e) {\n    if (!ds || !ds.length) {\n      return ds;\n    }\n\n    return DataUtil.select(ds, DataUtil.getValue(e.fieldNames));\n  };\n  /**\n   * Inserts new record in the table.\n   * @param  {DataManager} dm\n   * @param  {Object} data\n   * @param  {number} position\n   */\n\n\n  JsonAdaptor.prototype.insert = function (dm, data, tableName, query, position) {\n    if (isNullOrUndefined(position)) {\n      return dm.dataSource.json.push(data);\n    } else {\n      return dm.dataSource.json.splice(position, 0, data);\n    }\n  };\n  /**\n   * Remove the data from the dataSource based on the key field value.\n   * @param  {DataManager} dm\n   * @param  {string} keyField\n   * @param  {Object} value\n   * @param  {string} tableName?\n   * @returns null\n   */\n\n\n  JsonAdaptor.prototype.remove = function (dm, keyField, value, tableName) {\n    var ds = dm.dataSource.json;\n    var i;\n\n    if (typeof value === 'object' && !(value instanceof Date)) {\n      value = DataUtil.getObject(keyField, value);\n    }\n\n    for (i = 0; i < ds.length; i++) {\n      if (DataUtil.getObject(keyField, ds[i]) === value) {\n        break;\n      }\n    }\n\n    return i !== ds.length ? ds.splice(i, 1) : null;\n  };\n  /**\n   * Updates existing record and saves the changes to the table.\n   * @param  {DataManager} dm\n   * @param  {string} keyField\n   * @param  {Object} value\n   * @param  {string} tableName?\n   * @returns null\n   */\n\n\n  JsonAdaptor.prototype.update = function (dm, keyField, value, tableName) {\n    var ds = dm.dataSource.json;\n    var i;\n    var key;\n\n    if (!isNullOrUndefined(keyField)) {\n      key = getValue(keyField, value);\n    }\n\n    for (i = 0; i < ds.length; i++) {\n      if (!isNullOrUndefined(keyField) && getValue(keyField, ds[i]) === key) {\n        break;\n      }\n    }\n\n    return i < ds.length ? merge(ds[i], value) : null;\n  };\n\n  return JsonAdaptor;\n}(Adaptor);\n\nexport { JsonAdaptor };\n/**\n * URL Adaptor of DataManager can be used when you are required to use remote service to retrieve data.\n * It interacts with server-side for all DataManager Queries and CRUD operations.\n * @hidden\n */\n\nvar UrlAdaptor =\n/** @class */\nfunction (_super) {\n  __extends(UrlAdaptor, _super);\n\n  function UrlAdaptor() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  /**\n   * Process the query to generate request body.\n   * @param  {DataManager} dm\n   * @param  {Query} query\n   * @param  {Object[]} hierarchyFilters?\n   * @returns p\n   */\n  // tslint:disable-next-line:max-func-body-length\n\n\n  UrlAdaptor.prototype.processQuery = function (dm, query, hierarchyFilters) {\n    var queries = this.getQueryRequest(query);\n    var singles = Query.filterQueryLists(query.queries, ['onSelect', 'onPage', 'onSkip', 'onTake', 'onRange']);\n    var params = query.params;\n    var url = dm.dataSource.url;\n    var temp;\n    var skip;\n    var take = null;\n    var options = this.options;\n    var request = {\n      sorts: [],\n      groups: [],\n      filters: [],\n      searches: [],\n      aggregates: []\n    }; // calc Paging & Range\n\n    if ('onPage' in singles) {\n      temp = singles.onPage;\n      skip = DataUtil.getValue(temp.pageIndex, query);\n      take = DataUtil.getValue(temp.pageSize, query);\n      skip = (skip - 1) * take;\n    } else if ('onRange' in singles) {\n      temp = singles.onRange;\n      skip = temp.start;\n      take = temp.end - temp.start;\n    } // Sorting\n\n\n    for (var i = 0; i < queries.sorts.length; i++) {\n      temp = DataUtil.getValue(queries.sorts[i].e.fieldName, query);\n      request.sorts.push(DataUtil.callAdaptorFunction(this, 'onEachSort', {\n        name: temp,\n        direction: queries.sorts[i].e.direction\n      }, query));\n    } // hierarchy\n\n\n    if (hierarchyFilters) {\n      temp = this.getFiltersFrom(hierarchyFilters, query);\n\n      if (temp) {\n        request.filters.push(DataUtil.callAdaptorFunction(this, 'onEachWhere', temp.toJson(), query));\n      }\n    } // Filters\n\n\n    for (var i = 0; i < queries.filters.length; i++) {\n      request.filters.push(DataUtil.callAdaptorFunction(this, 'onEachWhere', queries.filters[i].e.toJson(), query));\n      var keys_3 = typeof request.filters[i] === 'object' ? Object.keys(request.filters[i]) : [];\n\n      for (var _i = 0, keys_1 = keys_3; _i < keys_1.length; _i++) {\n        var prop = keys_1[_i];\n\n        if (DataUtil.isNull(request[prop])) {\n          delete request[prop];\n        }\n      }\n    } // Searches\n\n\n    for (var i = 0; i < queries.searches.length; i++) {\n      temp = queries.searches[i].e;\n      request.searches.push(DataUtil.callAdaptorFunction(this, 'onEachSearch', {\n        fields: temp.fieldNames,\n        operator: temp.operator,\n        key: temp.searchKey,\n        ignoreCase: temp.ignoreCase\n      }, query));\n    } // Grouping\n\n\n    for (var i = 0; i < queries.groups.length; i++) {\n      request.groups.push(DataUtil.getValue(queries.groups[i].e.fieldName, query));\n    } // aggregates\n\n\n    for (var i = 0; i < queries.aggregates.length; i++) {\n      temp = queries.aggregates[i].e;\n      request.aggregates.push({\n        type: temp.type,\n        field: DataUtil.getValue(temp.field, query)\n      });\n    }\n\n    var req = {};\n    this.getRequestQuery(options, query, singles, request, req); // Params\n\n    DataUtil.callAdaptorFunction(this, 'addParams', {\n      dm: dm,\n      query: query,\n      params: params,\n      reqParams: req\n    });\n\n    if (query.lazyLoad.length) {\n      for (var i = 0; i < query.lazyLoad.length; i++) {\n        req[query.lazyLoad[i].key] = query.lazyLoad[i].value;\n      }\n    } // cleanup\n\n\n    var keys = Object.keys(req);\n\n    for (var _a = 0, keys_2 = keys; _a < keys_2.length; _a++) {\n      var prop = keys_2[_a];\n\n      if (DataUtil.isNull(req[prop]) || req[prop] === '' || req[prop].length === 0) {\n        delete req[prop];\n      }\n    }\n\n    if (!(options.skip in req && options.take in req) && take !== null) {\n      req[options.skip] = DataUtil.callAdaptorFunction(this, 'onSkip', skip, query);\n      req[options.take] = DataUtil.callAdaptorFunction(this, 'onTake', take, query);\n    }\n\n    var p = this.pvt;\n    this.pvt = {};\n\n    if (this.options.requestType === 'json') {\n      return {\n        data: JSON.stringify(req, DataUtil.parse.jsonDateReplacer),\n        url: url,\n        pvtData: p,\n        type: 'POST',\n        contentType: 'application/json; charset=utf-8'\n      };\n    }\n\n    temp = this.convertToQueryString(req, query, dm);\n    temp = (dm.dataSource.url.indexOf('?') !== -1 ? '&' : '/') + temp;\n    return {\n      type: 'GET',\n      url: temp.length ? url.replace(/\\/*$/, temp) : url,\n      pvtData: p\n    };\n  };\n\n  UrlAdaptor.prototype.getRequestQuery = function (options, query, singles, request, request1) {\n    var param = 'param';\n    var req = request1;\n    req[options.from] = query.fromTable;\n\n    if (options.apply && query.distincts.length) {\n      req[options.apply] = 'onDistinct' in this ? DataUtil.callAdaptorFunction(this, 'onDistinct', query.distincts) : '';\n    }\n\n    if (!query.distincts.length && options.expand) {\n      req[options.expand] = 'onExpand' in this && 'onSelect' in singles ? DataUtil.callAdaptorFunction(this, 'onExpand', {\n        selects: DataUtil.getValue(singles.onSelect.fieldNames, query),\n        expands: query.expands\n      }, query) : query.expands;\n    }\n\n    req[options.select] = 'onSelect' in singles && !query.distincts.length ? DataUtil.callAdaptorFunction(this, 'onSelect', DataUtil.getValue(singles.onSelect.fieldNames, query), query) : '';\n    req[options.count] = query.isCountRequired ? DataUtil.callAdaptorFunction(this, 'onCount', query.isCountRequired, query) : '';\n    req[options.search] = request.searches.length ? DataUtil.callAdaptorFunction(this, 'onSearch', request.searches, query) : '';\n    req[options.skip] = 'onSkip' in singles ? DataUtil.callAdaptorFunction(this, 'onSkip', DataUtil.getValue(singles.onSkip.nos, query), query) : '';\n    req[options.take] = 'onTake' in singles ? DataUtil.callAdaptorFunction(this, 'onTake', DataUtil.getValue(singles.onTake.nos, query), query) : '';\n    req[options.where] = request.filters.length || request.searches.length ? DataUtil.callAdaptorFunction(this, 'onWhere', request.filters, query) : '';\n    req[options.sortBy] = request.sorts.length ? DataUtil.callAdaptorFunction(this, 'onSortBy', request.sorts, query) : '';\n    req[options.group] = request.groups.length ? DataUtil.callAdaptorFunction(this, 'onGroup', request.groups, query) : '';\n    req[options.aggregates] = request.aggregates.length ? DataUtil.callAdaptorFunction(this, 'onAggregates', request.aggregates, query) : '';\n    req[param] = [];\n  };\n  /**\n   * Convert the object from processQuery to string which can be added query string.\n   * @param  {Object} req\n   * @param  {Query} query\n   * @param  {DataManager} dm\n   */\n\n\n  UrlAdaptor.prototype.convertToQueryString = function (request, query, dm) {\n    return ''; // this needs to be overridden\n  };\n  /**\n   * Return the data from the data manager processing.\n   * @param  {DataResult} data\n   * @param  {DataOptions} ds?\n   * @param  {Query} query?\n   * @param  {XMLHttpRequest} xhr?\n   * @param  {Object} request?\n   * @param  {CrudOptions} changes?\n   */\n\n\n  UrlAdaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n    if (xhr && xhr.getResponseHeader('Content-Type') && xhr.getResponseHeader('Content-Type').indexOf('application/json') !== -1) {\n      var handleTimeZone = DataUtil.timeZoneHandling;\n\n      if (ds && !ds.timeZoneHandling) {\n        DataUtil.timeZoneHandling = false;\n      }\n\n      data = DataUtil.parse.parseJson(data);\n      DataUtil.timeZoneHandling = handleTimeZone;\n    }\n\n    var requests = request;\n    var pvt = requests.pvtData || {};\n    var groupDs = data ? data.groupDs : [];\n\n    if (xhr && xhr.getResponseHeader('Content-Type') && xhr.getResponseHeader('Content-Type').indexOf('xml') !== -1) {\n      return query.isCountRequired ? {\n        result: [],\n        count: 0\n      } : [];\n    }\n\n    var d = JSON.parse(requests.data);\n\n    if (d && d.action === 'batch' && data && data.addedRecords) {\n      changes.addedRecords = data.addedRecords;\n      return changes;\n    }\n\n    if (data && data.d) {\n      data = data.d;\n    }\n\n    var args = {};\n\n    if (data && 'count' in data) {\n      args.count = data.count;\n    }\n\n    args.result = data && data.result ? data.result : data;\n    var isExpand = false;\n\n    if (Array.isArray(data.result) && data.result.length) {\n      var key = 'key';\n      var val = 'value';\n      var level = 'level';\n\n      if (!isNullOrUndefined(data.result[0][key])) {\n        args.result = this.formRemoteGroupedData(args.result, 1, pvt.groups.length - 1);\n      }\n\n      if (query && query.lazyLoad.length && pvt.groups.length) {\n        for (var i = 0; i < query.lazyLoad.length; i++) {\n          if (query.lazyLoad[i][key] === 'onDemandGroupInfo') {\n            var value = query.lazyLoad[i][val][level];\n\n            if (pvt.groups.length === value) {\n              isExpand = true;\n            }\n          }\n        }\n      }\n    }\n\n    if (!isExpand) {\n      this.getAggregateResult(pvt, data, args, groupDs, query);\n    }\n\n    return DataUtil.isNull(args.count) ? args.result : {\n      result: args.result,\n      count: args.count,\n      aggregates: args.aggregates\n    };\n  };\n\n  UrlAdaptor.prototype.formRemoteGroupedData = function (data, level, childLevel) {\n    for (var i = 0; i < data.length; i++) {\n      if (data[i].items.length && Object.keys(data[i].items[0]).indexOf('key') > -1) {\n        this.formRemoteGroupedData(data[i].items, level + 1, childLevel - 1);\n      }\n    }\n\n    var uid = 'GroupGuid';\n    var childLvl = 'childLevels';\n    var lvl = 'level';\n    var records = 'records';\n    data[uid] = consts[uid];\n    data[lvl] = level;\n    data[childLvl] = childLevel;\n    data[records] = data[0].items.length ? this.getGroupedRecords(data, !isNullOrUndefined(data[0].items[records])) : [];\n    return data;\n  };\n\n  UrlAdaptor.prototype.getGroupedRecords = function (data, hasRecords) {\n    var childGroupedRecords = [];\n    var records = 'records';\n\n    for (var i = 0; i < data.length; i++) {\n      if (!hasRecords) {\n        for (var j = 0; j < data[i].items.length; j++) {\n          childGroupedRecords.push(data[i].items[j]);\n        }\n      } else {\n        childGroupedRecords = childGroupedRecords.concat(data[i].items[records]);\n      }\n    }\n\n    return childGroupedRecords;\n  };\n  /**\n   * Add the group query to the adaptor`s option.\n   * @param  {Object[]} e\n   * @returns void\n   */\n\n\n  UrlAdaptor.prototype.onGroup = function (e) {\n    this.pvt.groups = e;\n    return e;\n  };\n  /**\n   * Add the aggregate query to the adaptor`s option.\n   * @param  {Aggregates[]} e\n   * @returns void\n   */\n\n\n  UrlAdaptor.prototype.onAggregates = function (e) {\n    this.pvt.aggregates = e;\n  };\n  /**\n   * Prepare the request body based on the newly added, removed and updated records.\n   * The result is used by the batch request.\n   * @param  {DataManager} dm\n   * @param  {CrudOptions} changes\n   * @param  {Object} e\n   */\n\n\n  UrlAdaptor.prototype.batchRequest = function (dm, changes, e, query, original) {\n    var url;\n    var key;\n    return {\n      type: 'POST',\n      url: dm.dataSource.batchUrl || dm.dataSource.crudUrl || dm.dataSource.removeUrl || dm.dataSource.url,\n      contentType: 'application/json; charset=utf-8',\n      dataType: 'json',\n      data: JSON.stringify(extend({}, {\n        changed: changes.changedRecords,\n        added: changes.addedRecords,\n        deleted: changes.deletedRecords,\n        action: 'batch',\n        table: e[url],\n        key: e[key]\n      }, DataUtil.getAddParams(this, dm, query)))\n    };\n  };\n  /**\n   * Method will trigger before send the request to server side.\n   * Used to set the custom header or modify the request options.\n   * @param  {DataManager} dm\n   * @param  {XMLHttpRequest} request\n   * @returns void\n   */\n\n\n  UrlAdaptor.prototype.beforeSend = function (dm, request) {// need to extend this method\n  };\n  /**\n   * Prepare and returns request body which is used to insert a new record in the table.\n   * @param  {DataManager} dm\n   * @param  {Object} data\n   * @param  {string} tableName\n   */\n\n\n  UrlAdaptor.prototype.insert = function (dm, data, tableName, query) {\n    return {\n      url: dm.dataSource.insertUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n      data: JSON.stringify(extend({}, {\n        value: data,\n        table: tableName,\n        action: 'insert'\n      }, DataUtil.getAddParams(this, dm, query)))\n    };\n  };\n  /**\n   * Prepare and return request body which is used to remove record from the table.\n   * @param  {DataManager} dm\n   * @param  {string} keyField\n   * @param  {number|string} value\n   * @param  {string} tableName\n   */\n\n\n  UrlAdaptor.prototype.remove = function (dm, keyField, value, tableName, query) {\n    return {\n      type: 'POST',\n      url: dm.dataSource.removeUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n      data: JSON.stringify(extend({}, {\n        key: value,\n        keyColumn: keyField,\n        table: tableName,\n        action: 'remove'\n      }, DataUtil.getAddParams(this, dm, query)))\n    };\n  };\n  /**\n   * Prepare and return request body which is used to update record.\n   * @param  {DataManager} dm\n   * @param  {string} keyField\n   * @param  {Object} value\n   * @param  {string} tableName\n   */\n\n\n  UrlAdaptor.prototype.update = function (dm, keyField, value, tableName, query) {\n    return {\n      type: 'POST',\n      url: dm.dataSource.updateUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n      data: JSON.stringify(extend({}, {\n        value: value,\n        action: 'update',\n        keyColumn: keyField,\n        key: DataUtil.getObject(keyField, value),\n        table: tableName\n      }, DataUtil.getAddParams(this, dm, query)))\n    };\n  };\n  /**\n   * To generate the predicate based on the filtered query.\n   * @param  {Object[]|string[]|number[]} data\n   * @param  {Query} query\n   * @hidden\n   */\n\n\n  UrlAdaptor.prototype.getFiltersFrom = function (data, query) {\n    var key = query.fKey;\n    var value;\n    var prop = key;\n    var pKey = query.key;\n    var predicats = [];\n\n    if (typeof data[0] !== 'object') {\n      prop = null;\n    }\n\n    for (var i = 0; i < data.length; i++) {\n      if (typeof data[0] === 'object') {\n        value = DataUtil.getObject(pKey || prop, data[i]);\n      } else {\n        value = data[i];\n      }\n\n      predicats.push(new Predicate(key, 'equal', value));\n    }\n\n    return Predicate.or(predicats);\n  };\n\n  UrlAdaptor.prototype.getAggregateResult = function (pvt, data, args, groupDs, query) {\n    var pData = data;\n\n    if (data && data.result) {\n      pData = data.result;\n    }\n\n    if (pvt && pvt.aggregates && pvt.aggregates.length) {\n      var agg = pvt.aggregates;\n      var fn = void 0;\n      var aggregateData = pData;\n      var res = {};\n\n      if (data.aggregate) {\n        aggregateData = data.aggregate;\n      }\n\n      for (var i = 0; i < agg.length; i++) {\n        fn = DataUtil.aggregates[agg[i].type];\n\n        if (fn) {\n          res[agg[i].field + ' - ' + agg[i].type] = fn(aggregateData, agg[i].field);\n        }\n      }\n\n      args.aggregates = res;\n    }\n\n    var key = 'key';\n    var isServerGrouping = Array.isArray(data.result) && data.result.length && !isNullOrUndefined(data.result[0][key]);\n\n    if (pvt && pvt.groups && pvt.groups.length && !isServerGrouping) {\n      var groups = pvt.groups;\n\n      for (var i = 0; i < groups.length; i++) {\n        var level = null;\n\n        if (!isNullOrUndefined(groupDs)) {\n          groupDs = DataUtil.group(groupDs, groups[i]);\n        }\n\n        var groupQuery = Query.filterQueries(query.queries, 'onGroup')[i].e;\n        pData = DataUtil.group(pData, groups[i], pvt.aggregates, level, groupDs, groupQuery.comparer);\n      }\n\n      args.result = pData;\n    }\n\n    return args;\n  };\n\n  UrlAdaptor.prototype.getQueryRequest = function (query) {\n    var req = {\n      sorts: [],\n      groups: [],\n      filters: [],\n      searches: [],\n      aggregates: []\n    };\n    req.sorts = Query.filterQueries(query.queries, 'onSortBy');\n    req.groups = Query.filterQueries(query.queries, 'onGroup');\n    req.filters = Query.filterQueries(query.queries, 'onWhere');\n    req.searches = Query.filterQueries(query.queries, 'onSearch');\n    req.aggregates = Query.filterQueries(query.queries, 'onAggregates');\n    return req;\n  };\n\n  UrlAdaptor.prototype.addParams = function (options) {\n    var req = options.reqParams;\n\n    if (options.params.length) {\n      req.params = {};\n    }\n\n    for (var _i = 0, _a = options.params; _i < _a.length; _i++) {\n      var tmp = _a[_i];\n\n      if (req[tmp.key]) {\n        throw new Error('Query() - addParams: Custom Param is conflicting other request arguments');\n      }\n\n      req[tmp.key] = tmp.value;\n\n      if (tmp.fn) {\n        req[tmp.key] = tmp.fn.call(options.query, tmp.key, options.query, options.dm);\n      }\n\n      req.params[tmp.key] = req[tmp.key];\n    }\n  };\n\n  return UrlAdaptor;\n}(Adaptor);\n\nexport { UrlAdaptor };\n/**\n * OData Adaptor that is extended from URL Adaptor, is used for consuming data through OData Service.\n * @hidden\n */\n\nvar ODataAdaptor =\n/** @class */\nfunction (_super) {\n  __extends(ODataAdaptor, _super);\n\n  function ODataAdaptor(props) {\n    var _this = _super.call(this) || this; // options replaced the default adaptor options\n\n\n    _this.options = extend({}, _this.options, {\n      requestType: 'get',\n      accept: 'application/json;odata=light;q=1,application/json;odata=verbose;q=0.5',\n      multipartAccept: 'multipart/mixed',\n      sortBy: '$orderby',\n      select: '$select',\n      skip: '$skip',\n      take: '$top',\n      count: '$inlinecount',\n      where: '$filter',\n      expand: '$expand',\n      batch: '$batch',\n      changeSet: '--changeset_',\n      batchPre: 'batch_',\n      contentId: 'Content-Id: ',\n      batchContent: 'Content-Type: multipart/mixed; boundary=',\n      changeSetContent: 'Content-Type: application/http\\nContent-Transfer-Encoding: binary ',\n      batchChangeSetContentType: 'Content-Type: application/json; charset=utf-8 ',\n      updateType: 'PUT'\n    });\n    extend(_this.options, props || {});\n    return _this;\n  }\n\n  ODataAdaptor.prototype.getModuleName = function () {\n    return 'ODataAdaptor';\n  };\n  /**\n   * Generate request string based on the filter criteria from query.\n   * @param  {Predicate} pred\n   * @param  {boolean} requiresCast?\n   */\n\n\n  ODataAdaptor.prototype.onPredicate = function (predicate, query, requiresCast) {\n    var returnValue = '';\n    var operator;\n    var guid;\n    var val = predicate.value;\n    var type = typeof val;\n    var field = predicate.field ? ODataAdaptor.getField(predicate.field) : null;\n\n    if (val instanceof Date) {\n      val = 'datetime\\'' + DataUtil.parse.replacer(val) + '\\'';\n    }\n\n    if (type === 'string') {\n      val = encodeURIComponent(val);\n      val = '\\'' + val + '\\'';\n\n      if (requiresCast) {\n        field = 'cast(' + field + ', \\'Edm.String\\')';\n      }\n\n      if (DataUtil.parse.isGuid(val)) {\n        guid = 'guid';\n      }\n\n      if (predicate.ignoreCase) {\n        if (!guid) {\n          field = 'tolower(' + field + ')';\n        }\n\n        val = val.toLowerCase();\n      }\n    }\n\n    operator = DataUtil.odBiOperator[predicate.operator];\n\n    if (operator) {\n      returnValue += field;\n      returnValue += operator;\n\n      if (guid) {\n        returnValue += guid;\n      }\n\n      return returnValue + val;\n    }\n\n    if (!isNullOrUndefined(this.getModuleName) && this.getModuleName() === 'ODataV4Adaptor') {\n      operator = DataUtil.odv4UniOperator[predicate.operator];\n    } else {\n      operator = DataUtil.odUniOperator[predicate.operator];\n    }\n\n    if (operator === 'substringof') {\n      var temp = val;\n      val = field;\n      field = temp;\n    }\n\n    returnValue += operator + '(';\n    returnValue += field + ',';\n\n    if (guid) {\n      returnValue += guid;\n    }\n\n    returnValue += val + ')';\n    return returnValue;\n  };\n\n  ODataAdaptor.prototype.addParams = function (options) {\n    _super.prototype.addParams.call(this, options);\n\n    delete options.reqParams.params;\n  };\n  /**\n   * Generate request string based on the multiple filter criteria from query.\n   * @param  {Predicate} pred\n   * @param  {boolean} requiresCast?\n   */\n\n\n  ODataAdaptor.prototype.onComplexPredicate = function (predicate, query, requiresCast) {\n    var res = [];\n\n    for (var i = 0; i < predicate.predicates.length; i++) {\n      res.push('(' + this.onEachWhere(predicate.predicates[i], query, requiresCast) + ')');\n    }\n\n    return res.join(' ' + predicate.condition + ' ');\n  };\n  /**\n   * Generate query string based on the multiple filter criteria from query.\n   * @param  {Predicate} filter\n   * @param  {boolean} requiresCast?\n   */\n\n\n  ODataAdaptor.prototype.onEachWhere = function (filter, query, requiresCast) {\n    return filter.isComplex ? this.onComplexPredicate(filter, query, requiresCast) : this.onPredicate(filter, query, requiresCast);\n  };\n  /**\n   * Generate query string based on the multiple filter criteria from query.\n   * @param  {string[]} filters\n   */\n\n\n  ODataAdaptor.prototype.onWhere = function (filters) {\n    if (this.pvt.search) {\n      filters.push(this.onEachWhere(this.pvt.search, null, true));\n    }\n\n    return filters.join(' and ');\n  };\n  /**\n   * Generate query string based on the multiple search criteria from query.\n   * @param  {{fields:string[]} e\n   * @param  {string} operator\n   * @param  {string} key\n   * @param  {boolean}} ignoreCase\n   */\n\n\n  ODataAdaptor.prototype.onEachSearch = function (e) {\n    if (e.fields && e.fields.length === 0) {\n      DataUtil.throwError('Query() - Search : oData search requires list of field names to search');\n    }\n\n    var filter = this.pvt.search || [];\n\n    for (var i = 0; i < e.fields.length; i++) {\n      filter.push(new Predicate(e.fields[i], e.operator, e.key, e.ignoreCase));\n    }\n\n    this.pvt.search = filter;\n  };\n  /**\n   * Generate query string based on the search criteria from query.\n   * @param  {Object} e\n   */\n\n\n  ODataAdaptor.prototype.onSearch = function (e) {\n    this.pvt.search = Predicate.or(this.pvt.search);\n    return '';\n  };\n  /**\n   * Generate query string based on multiple sort criteria from query.\n   * @param  {QueryOptions} e\n   */\n\n\n  ODataAdaptor.prototype.onEachSort = function (e) {\n    var res = [];\n\n    if (e.name instanceof Array) {\n      for (var i = 0; i < e.name.length; i++) {\n        res.push(ODataAdaptor.getField(e.name[i]) + (e.direction === 'descending' ? ' desc' : ''));\n      }\n    } else {\n      res.push(ODataAdaptor.getField(e.name) + (e.direction === 'descending' ? ' desc' : ''));\n    }\n\n    return res.join(',');\n  };\n  /**\n   * Returns sort query string.\n   * @param  {string[]} e\n   */\n\n\n  ODataAdaptor.prototype.onSortBy = function (e) {\n    return e.reverse().join(',');\n  };\n  /**\n   * Adds the group query to the adaptor option.\n   * @param  {Object[]} e\n   * @returns string\n   */\n\n\n  ODataAdaptor.prototype.onGroup = function (e) {\n    this.pvt.groups = e;\n    return [];\n  };\n  /**\n   * Returns the select query string.\n   * @param  {string[]} e\n   */\n\n\n  ODataAdaptor.prototype.onSelect = function (e) {\n    for (var i = 0; i < e.length; i++) {\n      e[i] = ODataAdaptor.getField(e[i]);\n    }\n\n    return e.join(',');\n  };\n  /**\n   * Add the aggregate query to the adaptor option.\n   * @param  {Object[]} e\n   * @returns string\n   */\n\n\n  ODataAdaptor.prototype.onAggregates = function (e) {\n    this.pvt.aggregates = e;\n    return '';\n  };\n  /**\n   * Returns the query string which requests total count from the data source.\n   * @param  {boolean} e\n   * @returns string\n   */\n\n\n  ODataAdaptor.prototype.onCount = function (e) {\n    return e === true ? 'allpages' : '';\n  };\n  /**\n   * Method will trigger before send the request to server side.\n   * Used to set the custom header or modify the request options.\n   * @param  {DataManager} dm\n   * @param  {XMLHttpRequest} request\n   * @param  {Ajax} settings?\n   */\n\n\n  ODataAdaptor.prototype.beforeSend = function (dm, request, settings) {\n    if (DataUtil.endsWith(settings.url, this.options.batch) && settings.type.toLowerCase() === 'post') {\n      request.setRequestHeader('Accept', this.options.multipartAccept);\n      request.setRequestHeader('DataServiceVersion', '2.0');\n      request.overrideMimeType('text/plain; charset=x-user-defined');\n    } else {\n      request.setRequestHeader('Accept', this.options.accept);\n    }\n\n    request.setRequestHeader('DataServiceVersion', '2.0');\n    request.setRequestHeader('MaxDataServiceVersion', '2.0');\n  };\n  /**\n   * Returns the data from the query processing.\n   * @param  {DataResult} data\n   * @param  {DataOptions} ds?\n   * @param  {Query} query?\n   * @param  {XMLHttpRequest} xhr?\n   * @param  {Ajax} request?\n   * @param  {CrudOptions} changes?\n   * @returns aggregateResult\n   */\n\n\n  ODataAdaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n    var metaCheck = 'odata.metadata';\n\n    if (request && request.type === 'GET' && !this.rootUrl && data[metaCheck]) {\n      var dataUrls = data[metaCheck].split('/$metadata#');\n      this.rootUrl = dataUrls[0];\n      this.resourceTableName = dataUrls[1];\n    }\n\n    var pvtData = 'pvtData';\n\n    if (!isNullOrUndefined(data.d)) {\n      var dataCopy = query && query.isCountRequired ? data.d.results : data.d;\n      var metaData = '__metadata';\n\n      if (!isNullOrUndefined(dataCopy)) {\n        for (var i = 0; i < dataCopy.length; i++) {\n          if (!isNullOrUndefined(dataCopy[i][metaData])) {\n            delete dataCopy[i][metaData];\n          }\n        }\n      }\n    }\n\n    var pvt = request && request[pvtData];\n    var emptyAndBatch = this.processBatchResponse(data, query, xhr, request, changes);\n\n    if (emptyAndBatch) {\n      return emptyAndBatch;\n    }\n\n    var versionCheck = xhr && request.getResponseHeader('DataServiceVersion');\n    var count = null;\n    var version = versionCheck && parseInt(versionCheck, 10) || 2;\n\n    if (query && query.isCountRequired) {\n      var oDataCount = '__count';\n\n      if (data[oDataCount] || data['odata.count']) {\n        count = data[oDataCount] || data['odata.count'];\n      }\n\n      if (data.d) {\n        data = data.d;\n      }\n\n      if (data[oDataCount] || data['odata.count']) {\n        count = data[oDataCount] || data['odata.count'];\n      }\n    }\n\n    if (version === 3 && data.value) {\n      data = data.value;\n    }\n\n    if (data.d) {\n      data = data.d;\n    }\n\n    if (version < 3 && data.results) {\n      data = data.results;\n    }\n\n    var args = {};\n    args.count = count;\n    args.result = data;\n    this.getAggregateResult(pvt, data, args, null, query);\n    return DataUtil.isNull(count) ? args.result : {\n      result: args.result,\n      count: args.count,\n      aggregates: args.aggregates\n    };\n  };\n  /**\n   * Converts the request object to query string.\n   * @param  {Object} req\n   * @param  {Query} query\n   * @param  {DataManager} dm\n   * @returns tableName\n   */\n\n\n  ODataAdaptor.prototype.convertToQueryString = function (request, query, dm) {\n    var res = [];\n    var table = 'table';\n    var tableName = request[table] || '';\n    var format = '$format';\n    delete request[table];\n\n    if (dm.dataSource.requiresFormat) {\n      request[format] = 'json';\n    }\n\n    var keys = Object.keys(request);\n\n    for (var _i = 0, keys_4 = keys; _i < keys_4.length; _i++) {\n      var prop = keys_4[_i];\n      res.push(prop + '=' + request[prop]);\n    }\n\n    res = res.join('&');\n\n    if (dm.dataSource.url && dm.dataSource.url.indexOf('?') !== -1 && !tableName) {\n      return res;\n    }\n\n    return res.length ? tableName + '?' + res : tableName || '';\n  };\n\n  ODataAdaptor.prototype.localTimeReplacer = function (key, convertObj) {\n    for (var _i = 0, _a = !isNullOrUndefined(convertObj) ? Object.keys(convertObj) : []; _i < _a.length; _i++) {\n      var prop = _a[_i];\n\n      if (convertObj[prop] instanceof Date) {\n        convertObj[prop] = DataUtil.dateParse.toLocalTime(convertObj[prop]);\n      }\n    }\n\n    return convertObj;\n  };\n  /**\n   * Prepare and returns request body which is used to insert a new record in the table.\n   * @param  {DataManager} dm\n   * @param  {Object} data\n   * @param  {string} tableName?\n   */\n\n\n  ODataAdaptor.prototype.insert = function (dm, data, tableName) {\n    return {\n      url: (dm.dataSource.insertUrl || dm.dataSource.url).replace(/\\/*$/, tableName ? '/' + tableName : ''),\n      data: JSON.stringify(data, this.options.localTime ? this.localTimeReplacer : null)\n    };\n  };\n  /**\n   * Prepare and return request body which is used to remove record from the table.\n   * @param  {DataManager} dm\n   * @param  {string} keyField\n   * @param  {number} value\n   * @param  {string} tableName?\n   */\n\n\n  ODataAdaptor.prototype.remove = function (dm, keyField, value, tableName) {\n    var url;\n\n    if (typeof value === 'string' && !DataUtil.parse.isGuid(value)) {\n      url = \"('\" + value + \"')\";\n    } else {\n      url = \"(\" + value + \")\";\n    }\n\n    return {\n      type: 'DELETE',\n      url: (dm.dataSource.removeUrl || dm.dataSource.url).replace(/\\/*$/, tableName ? '/' + tableName : '') + url\n    };\n  };\n  /**\n   * Updates existing record and saves the changes to the table.\n   * @param  {DataManager} dm\n   * @param  {string} keyField\n   * @param  {Object} value\n   * @param  {string} tableName?\n   * @returns this\n   */\n\n\n  ODataAdaptor.prototype.update = function (dm, keyField, value, tableName, query, original) {\n    if (this.options.updateType === 'PATCH' && !isNullOrUndefined(original)) {\n      value = this.compareAndRemove(value, original, keyField);\n    }\n\n    var url;\n\n    if (typeof value[keyField] === 'string' && !DataUtil.parse.isGuid(value[keyField])) {\n      url = \"('\" + value[keyField] + \"')\";\n    } else {\n      url = \"(\" + value[keyField] + \")\";\n    }\n\n    return {\n      type: this.options.updateType,\n      url: (dm.dataSource.updateUrl || dm.dataSource.url).replace(/\\/*$/, tableName ? '/' + tableName : '') + url,\n      data: JSON.stringify(value, this.options.localTime ? this.localTimeReplacer : null),\n      accept: this.options.accept\n    };\n  };\n  /**\n   * Prepare the request body based on the newly added, removed and updated records.\n   * The result is used by the batch request.\n   * @param  {DataManager} dm\n   * @param  {CrudOptions} changes\n   * @param  {RemoteArgs} e\n   * @returns {Object}\n   */\n\n\n  ODataAdaptor.prototype.batchRequest = function (dm, changes, e, query, original) {\n    var initialGuid = e.guid = DataUtil.getGuid(this.options.batchPre);\n    var url = this.rootUrl ? this.rootUrl + '/' + this.options.batch : dm.dataSource.url.replace(/\\/*$/, '/' + this.options.batch);\n    e.url = this.resourceTableName ? this.resourceTableName : e.url;\n    var args = {\n      url: e.url,\n      key: e.key,\n      cid: 1,\n      cSet: DataUtil.getGuid(this.options.changeSet)\n    };\n    var req = '--' + initialGuid + '\\n';\n    req += 'Content-Type: multipart/mixed; boundary=' + args.cSet.replace('--', '') + '\\n';\n    this.pvt.changeSet = 0;\n    req += this.generateInsertRequest(changes.addedRecords, args, dm);\n    req += this.generateUpdateRequest(changes.changedRecords, args, dm, original ? original.changedRecords : []);\n    req += this.generateDeleteRequest(changes.deletedRecords, args, dm);\n    req += args.cSet + '--\\n';\n    req += '--' + initialGuid + '--';\n    return {\n      type: 'POST',\n      url: url,\n      dataType: 'json',\n      contentType: 'multipart/mixed; charset=UTF-8;boundary=' + initialGuid,\n      data: req\n    };\n  };\n  /**\n   * Generate the string content from the removed records.\n   * The result will be send during batch update.\n   * @param  {Object[]} arr\n   * @param  {RemoteArgs} e\n   * @returns this\n   */\n\n\n  ODataAdaptor.prototype.generateDeleteRequest = function (arr, e, dm) {\n    if (!arr) {\n      return '';\n    }\n\n    var req = '';\n    var stat = {\n      'method': 'DELETE ',\n      'url': function (data, i, key) {\n        var url = DataUtil.getObject(key, data[i]);\n\n        if (typeof url === 'number' || DataUtil.parse.isGuid(url)) {\n          return '(' + url + ')';\n        } else if (url instanceof Date) {\n          var dateTime = data[i][key];\n          return '(' + dateTime.toJSON() + ')';\n        } else {\n          return \"('\" + url + \"')\";\n        }\n      },\n      'data': function (data, i) {\n        return '';\n      }\n    };\n    req = this.generateBodyContent(arr, e, stat, dm);\n    return req + '\\n';\n  };\n  /**\n   * Generate the string content from the inserted records.\n   * The result will be send during batch update.\n   * @param  {Object[]} arr\n   * @param  {RemoteArgs} e\n   */\n\n\n  ODataAdaptor.prototype.generateInsertRequest = function (arr, e, dm) {\n    if (!arr) {\n      return '';\n    }\n\n    var req = '';\n    var stat = {\n      'method': 'POST ',\n      'url': function (data, i, key) {\n        return '';\n      },\n      'data': function (data, i) {\n        return JSON.stringify(data[i]) + '\\n\\n';\n      }\n    };\n    req = this.generateBodyContent(arr, e, stat, dm);\n    return req;\n  };\n  /**\n   * Generate the string content from the updated records.\n   * The result will be send during batch update.\n   * @param  {Object[]} arr\n   * @param  {RemoteArgs} e\n   */\n\n\n  ODataAdaptor.prototype.generateUpdateRequest = function (arr, e, dm, org) {\n    var _this = this;\n\n    if (!arr) {\n      return '';\n    }\n\n    var req = '';\n    arr.forEach(function (change) {\n      return change = _this.compareAndRemove(change, org.filter(function (o) {\n        return DataUtil.getObject(e.key, o) === DataUtil.getObject(e.key, change);\n      })[0], e.key);\n    });\n    var stat = {\n      'method': this.options.updateType + ' ',\n      'url': function (data, i, key) {\n        if (typeof data[i][key] === 'number' || DataUtil.parse.isGuid(data[i][key])) {\n          return '(' + data[i][key] + ')';\n        } else if (data[i][key] instanceof Date) {\n          var date = data[i][key];\n          return '(' + date.toJSON() + ')';\n        } else {\n          return \"('\" + data[i][key] + \"')\";\n        }\n      },\n      'data': function (data, i) {\n        return JSON.stringify(data[i]) + '\\n\\n';\n      }\n    };\n    req = this.generateBodyContent(arr, e, stat, dm);\n    return req;\n  };\n\n  ODataAdaptor.getField = function (prop) {\n    return prop.replace(/\\./g, '/');\n  };\n\n  ODataAdaptor.prototype.generateBodyContent = function (arr, e, stat, dm) {\n    var req = '';\n\n    for (var i = 0; i < arr.length; i++) {\n      req += '\\n' + e.cSet + '\\n';\n      req += this.options.changeSetContent + '\\n\\n';\n      req += stat.method;\n\n      if (stat.method === 'POST ') {\n        req += (dm.dataSource.insertUrl || dm.dataSource.crudUrl || e.url) + stat.url(arr, i, e.key) + ' HTTP/1.1\\n';\n      } else if (stat.method === 'PUT ' || stat.method === 'PATCH ') {\n        req += (dm.dataSource.updateUrl || dm.dataSource.crudUrl || e.url) + stat.url(arr, i, e.key) + ' HTTP/1.1\\n';\n      } else if (stat.method === 'DELETE ') {\n        req += (dm.dataSource.removeUrl || dm.dataSource.crudUrl || e.url) + stat.url(arr, i, e.key) + ' HTTP/1.1\\n';\n      }\n\n      req += 'Accept: ' + this.options.accept + '\\n';\n      req += 'Content-Id: ' + this.pvt.changeSet++ + '\\n';\n      req += this.options.batchChangeSetContentType + '\\n';\n\n      if (!isNullOrUndefined(arr[i]['@odata.etag'])) {\n        req += 'If-Match: ' + arr[i]['@odata.etag'] + '\\n\\n';\n        delete arr[i]['@odata.etag'];\n      } else {\n        req += '\\n';\n      }\n\n      req += stat.data(arr, i);\n    }\n\n    return req;\n  };\n\n  ODataAdaptor.prototype.processBatchResponse = function (data, query, xhr, request, changes) {\n    if (xhr && xhr.getResponseHeader('Content-Type') && xhr.getResponseHeader('Content-Type').indexOf('xml') !== -1) {\n      return query.isCountRequired ? {\n        result: [],\n        count: 0\n      } : [];\n    }\n\n    if (request && this.options.batch && DataUtil.endsWith(request.url, this.options.batch) && request.type.toLowerCase() === 'post') {\n      var guid = xhr.getResponseHeader('Content-Type');\n      var cIdx = void 0;\n      var jsonObj = void 0;\n      var d = data + '';\n      guid = guid.substring(guid.indexOf('=batchresponse') + 1);\n      d = d.split(guid);\n\n      if (d.length < 2) {\n        return {};\n      }\n\n      d = d[1];\n      var exVal = /(?:\\bContent-Type.+boundary=)(changesetresponse.+)/i.exec(d);\n\n      if (exVal) {\n        d.replace(exVal[0], '');\n      }\n\n      var changeGuid = exVal ? exVal[1] : '';\n      d = d.split(changeGuid);\n\n      for (var i = d.length; i > -1; i--) {\n        if (!/\\bContent-ID:/i.test(d[i]) || !/\\bHTTP.+201/.test(d[i])) {\n          continue;\n        }\n\n        cIdx = parseInt(/\\bContent-ID: (\\d+)/i.exec(d[i])[1], 10);\n\n        if (changes.addedRecords[cIdx]) {\n          jsonObj = DataUtil.parse.parseJson(/^\\{.+\\}/m.exec(d[i])[0]);\n          extend({}, changes.addedRecords[cIdx], this.processResponse(jsonObj));\n        }\n      }\n\n      return changes;\n    }\n\n    return null;\n  };\n\n  ODataAdaptor.prototype.compareAndRemove = function (data, original, key) {\n    var _this = this;\n\n    if (isNullOrUndefined(original)) {\n      return data;\n    }\n\n    Object.keys(data).forEach(function (prop) {\n      if (prop !== key && prop !== '@odata.etag') {\n        if (DataUtil.isPlainObject(data[prop])) {\n          _this.compareAndRemove(data[prop], original[prop]);\n\n          var final = Object.keys(data[prop]).filter(function (data) {\n            return data !== '@odata.etag';\n          });\n\n          if (final.length === 0) {\n            delete data[prop];\n          }\n        } else if (data[prop] === original[prop]) {\n          delete data[prop];\n        } else if (data[prop] && original[prop] && data[prop].valueOf() === original[prop].valueOf()) {\n          delete data[prop];\n        }\n      }\n    });\n    return data;\n  };\n\n  return ODataAdaptor;\n}(UrlAdaptor);\n\nexport { ODataAdaptor };\n/**\n * The OData v4 is an improved version of OData protocols.\n * The DataManager uses the ODataV4Adaptor to consume OData v4 services.\n * @hidden\n */\n\nvar ODataV4Adaptor =\n/** @class */\nfunction (_super) {\n  __extends(ODataV4Adaptor, _super);\n\n  function ODataV4Adaptor(props) {\n    var _this = _super.call(this, props) || this; // options replaced the default adaptor options\n\n\n    _this.options = extend({}, _this.options, {\n      requestType: 'get',\n      accept: 'application/json, text/javascript, */*; q=0.01',\n      multipartAccept: 'multipart/mixed',\n      sortBy: '$orderby',\n      select: '$select',\n      skip: '$skip',\n      take: '$top',\n      count: '$count',\n      search: '$search',\n      where: '$filter',\n      expand: '$expand',\n      batch: '$batch',\n      changeSet: '--changeset_',\n      batchPre: 'batch_',\n      contentId: 'Content-Id: ',\n      batchContent: 'Content-Type: multipart/mixed; boundary=',\n      changeSetContent: 'Content-Type: application/http\\nContent-Transfer-Encoding: binary ',\n      batchChangeSetContentType: 'Content-Type: application/json; charset=utf-8 ',\n      updateType: 'PATCH',\n      localTime: false,\n      apply: '$apply'\n    });\n    extend(_this.options, props || {});\n    return _this;\n  }\n  /**\n   * @hidden\n   */\n\n\n  ODataV4Adaptor.prototype.getModuleName = function () {\n    return 'ODataV4Adaptor';\n  };\n  /**\n   * Returns the query string which requests total count from the data source.\n   * @param  {boolean} e\n   * @returns string\n   */\n\n\n  ODataV4Adaptor.prototype.onCount = function (e) {\n    return e === true ? 'true' : '';\n  };\n  /**\n   * Generate request string based on the filter criteria from query.\n   * @param  {Predicate} pred\n   * @param  {boolean} requiresCast?\n   */\n\n\n  ODataV4Adaptor.prototype.onPredicate = function (predicate, query, requiresCast) {\n    var returnValue = '';\n    var val = predicate.value;\n    var isDate = val instanceof Date;\n\n    if (query instanceof Query) {\n      var queries = this.getQueryRequest(query);\n\n      for (var i = 0; i < queries.filters.length; i++) {\n        if (queries.filters[i].e.key === predicate.value) {\n          requiresCast = true;\n        }\n      }\n    }\n\n    returnValue = _super.prototype.onPredicate.call(this, predicate, query, requiresCast);\n\n    if (isDate) {\n      returnValue = returnValue.replace(/datetime'(.*)'$/, '$1');\n    }\n\n    if (DataUtil.parse.isGuid(val)) {\n      returnValue = returnValue.replace('guid', '').replace(/'/g, '');\n    }\n\n    return returnValue;\n  };\n  /**\n   *  Generate query string based on the multiple search criteria from query.\n   * @param  {{fields:string[]} e\n   * @param  {string} operator\n   * @param  {string} key\n   * @param  {boolean}} ignoreCase\n   */\n\n\n  ODataV4Adaptor.prototype.onEachSearch = function (e) {\n    var search = this.pvt.searches || [];\n    search.push(e.key);\n    this.pvt.searches = search;\n  };\n  /**\n   *  Generate query string based on the search criteria from query.\n   * @param  {Object} e\n   */\n\n\n  ODataV4Adaptor.prototype.onSearch = function (e) {\n    return this.pvt.searches.join(' OR ');\n  };\n  /**\n   * Returns the expand query string.\n   * @param  {string} e\n   */\n\n\n  ODataV4Adaptor.prototype.onExpand = function (e) {\n    var _this = this;\n\n    var selected = {};\n    var expanded = {};\n    var expands = e.expands.slice();\n    var exArr = [];\n    var selects = e.selects.filter(function (item) {\n      return item.indexOf('.') > -1;\n    });\n    selects.forEach(function (select) {\n      var splits = select.split('.');\n\n      if (!(splits[0] in selected)) {\n        selected[splits[0]] = [];\n      }\n\n      selected[splits[0]].push(splits[1]);\n    }); //Auto expand from select query\n\n    Object.keys(selected).forEach(function (expand) {\n      if (expands.indexOf(expand) === -1) {\n        expands.push(expand);\n      }\n    });\n    expands.forEach(function (expand) {\n      expanded[expand] = expand in selected ? expand + \"(\" + _this.options.select + \"=\" + selected[expand].join(',') + \")\" : expand;\n    });\n    Object.keys(expanded).forEach(function (ex) {\n      return exArr.push(expanded[ex]);\n    });\n    return exArr.join(',');\n  };\n  /**\n   * Returns the groupby query string.\n   * @param  {string} e\n   */\n\n\n  ODataV4Adaptor.prototype.onDistinct = function (distinctFields) {\n    var fields = distinctFields.map(function (field) {\n      return ODataAdaptor.getField(field);\n    }).join(',');\n    return \"groupby((\" + fields + \"))\";\n  };\n  /**\n   * Returns the select query string.\n   * @param  {string[]} e\n   */\n\n\n  ODataV4Adaptor.prototype.onSelect = function (e) {\n    return _super.prototype.onSelect.call(this, e.filter(function (item) {\n      return item.indexOf('.') === -1;\n    }));\n  };\n  /**\n   * Method will trigger before send the request to server side.\n   * Used to set the custom header or modify the request options.\n   * @param  {DataManager} dm\n   * @param  {XMLHttpRequest} request\n   * @param  {Ajax} settings\n   * @returns void\n   */\n\n\n  ODataV4Adaptor.prototype.beforeSend = function (dm, request, settings) {\n    if (settings.type === 'POST' || settings.type === 'PUT' || settings.type === 'PATCH') {\n      request.setRequestHeader('Prefer', 'return=representation');\n    }\n\n    request.setRequestHeader('Accept', this.options.accept);\n  };\n  /**\n   * Returns the data from the query processing.\n   * @param  {DataResult} data\n   * @param  {DataOptions} ds?\n   * @param  {Query} query?\n   * @param  {XMLHttpRequest} xhr?\n   * @param  {Ajax} request?\n   * @param  {CrudOptions} changes?\n   * @returns aggregateResult\n   */\n\n\n  ODataV4Adaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n    var metaName = '@odata.context';\n\n    if (request && request.type === 'GET' && !this.rootUrl && data[metaName]) {\n      var dataUrl = data[metaName].split('/$metadata#');\n      this.rootUrl = dataUrl[0];\n      this.resourceTableName = dataUrl[1];\n    }\n\n    var pvtData = 'pvtData';\n    var pvt = request && request[pvtData];\n\n    var emptyAndBatch = _super.prototype.processBatchResponse.call(this, data, query, xhr, request, changes);\n\n    if (emptyAndBatch) {\n      return emptyAndBatch;\n    }\n\n    var count = null;\n    var dataCount = '@odata.count';\n\n    if (query && query.isCountRequired) {\n      if (dataCount in data) {\n        count = data[dataCount];\n      }\n    }\n\n    data = !isNullOrUndefined(data.value) ? data.value : data;\n    var args = {};\n    args.count = count;\n    args.result = data;\n    this.getAggregateResult(pvt, data, args, null, query);\n    return DataUtil.isNull(count) ? args.result : {\n      result: args.result,\n      count: count,\n      aggregates: args.aggregates\n    };\n  };\n\n  return ODataV4Adaptor;\n}(ODataAdaptor);\n\nexport { ODataV4Adaptor };\n/**\n * The Web API is a programmatic interface to define the request and response messages system that is mostly exposed in JSON or XML.\n * The DataManager uses the WebApiAdaptor to consume Web API.\n * Since this adaptor is targeted to interact with Web API created using OData endpoint, it is extended from ODataAdaptor\n * @hidden\n */\n\nvar WebApiAdaptor =\n/** @class */\nfunction (_super) {\n  __extends(WebApiAdaptor, _super);\n\n  function WebApiAdaptor() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  WebApiAdaptor.prototype.getModuleName = function () {\n    return 'WebApiAdaptor';\n  };\n  /**\n   * Prepare and returns request body which is used to insert a new record in the table.\n   * @param  {DataManager} dm\n   * @param  {Object} data\n   * @param  {string} tableName?\n   */\n\n\n  WebApiAdaptor.prototype.insert = function (dm, data, tableName) {\n    return {\n      type: 'POST',\n      url: dm.dataSource.url,\n      data: JSON.stringify(data)\n    };\n  };\n  /**\n   * Prepare and return request body which is used to remove record from the table.\n   * @param  {DataManager} dm\n   * @param  {string} keyField\n   * @param  {number} value\n   * @param  {string} tableName?\n   */\n\n\n  WebApiAdaptor.prototype.remove = function (dm, keyField, value, tableName) {\n    return {\n      type: 'DELETE',\n      url: dm.dataSource.url + '/' + value,\n      data: JSON.stringify(value)\n    };\n  };\n  /**\n   * Prepare and return request body which is used to update record.\n   * @param  {DataManager} dm\n   * @param  {string} keyField\n   * @param  {Object} value\n   * @param  {string} tableName?\n   */\n\n\n  WebApiAdaptor.prototype.update = function (dm, keyField, value, tableName) {\n    return {\n      type: 'PUT',\n      url: dm.dataSource.url,\n      data: JSON.stringify(value)\n    };\n  };\n\n  WebApiAdaptor.prototype.batchRequest = function (dm, changes, e) {\n    var _this = this;\n\n    var initialGuid = e.guid = DataUtil.getGuid(this.options.batchPre);\n    var url = dm.dataSource.url.replace(/\\/*$/, '/' + this.options.batch);\n    e.url = this.resourceTableName ? this.resourceTableName : e.url;\n    var req = [];\n\n    var _loop_1 = function (i, x) {\n      changes.addedRecords.forEach(function (j, d) {\n        var stat = {\n          'method': 'POST ',\n          'url': function (data, i, key) {\n            return '';\n          },\n          'data': function (data, i) {\n            return JSON.stringify(data[i]) + '\\n\\n';\n          }\n        };\n        req.push('--' + initialGuid);\n        req.push('Content-Type: application/http; msgtype=request', '');\n        req.push('POST ' + '/api/' + (dm.dataSource.insertUrl || dm.dataSource.crudUrl || e.url) + stat.url(changes.addedRecords, i, e.key) + ' HTTP/1.1');\n        req.push('Content-Type: ' + 'application/json; charset=utf-8');\n        req.push('Host: ' + location.host);\n        req.push('', j ? JSON.stringify(j) : '');\n      });\n    }; //insertion\n\n\n    for (var i = 0, x = changes.addedRecords.length; i < x; i++) {\n      _loop_1(i, x);\n    }\n\n    var _loop_2 = function (i, x) {\n      changes.changedRecords.forEach(function (j, d) {\n        var stat = {\n          'method': _this.options.updateType + ' ',\n          'url': function (data, i, key) {\n            return '';\n          },\n          'data': function (data, i) {\n            return JSON.stringify(data[i]) + '\\n\\n';\n          }\n        };\n        req.push('--' + initialGuid);\n        req.push('Content-Type: application/http; msgtype=request', '');\n        req.push('PUT ' + '/api/' + (dm.dataSource.updateUrl || dm.dataSource.crudUrl || e.url) + stat.url(changes.changedRecords, i, e.key) + ' HTTP/1.1');\n        req.push('Content-Type: ' + 'application/json; charset=utf-8');\n        req.push('Host: ' + location.host);\n        req.push('', j ? JSON.stringify(j) : '');\n      });\n    }; //updation \n\n\n    for (var i = 0, x = changes.changedRecords.length; i < x; i++) {\n      _loop_2(i, x);\n    }\n\n    var _loop_3 = function (i, x) {\n      changes.deletedRecords.forEach(function (j, d) {\n        var state = {\n          'mtd': 'DELETE ',\n          'url': function (data, i, key) {\n            var url = DataUtil.getObject(key, data[i]);\n\n            if (typeof url === 'number' || DataUtil.parse.isGuid(url)) {\n              return '/' + url;\n            } else if (url instanceof Date) {\n              var datTime = data[i][key];\n              return '/' + datTime.toJSON();\n            } else {\n              return \"/'\" + url + \"'\";\n            }\n          },\n          'data': function (data, i) {\n            return '';\n          }\n        };\n        req.push('--' + initialGuid);\n        req.push('Content-Type: application/http; msgtype=request', '');\n        req.push('DELETE ' + '/api/' + (dm.dataSource.removeUrl || dm.dataSource.crudUrl || e.url) + state.url(changes.deletedRecords, i, e.key) + ' HTTP/1.1');\n        req.push('Content-Type: ' + 'application/json; charset=utf-8');\n        req.push('Host: ' + location.host);\n        req.push('', j ? JSON.stringify(j) : '');\n      });\n    }; //deletion\n\n\n    for (var i = 0, x = changes.deletedRecords.length; i < x; i++) {\n      _loop_3(i, x);\n    }\n\n    req.push('--' + initialGuid + '--', '');\n    return {\n      type: 'POST',\n      url: url,\n      contentType: 'multipart/mixed; boundary=' + initialGuid,\n      data: req.join('\\r\\n')\n    };\n  };\n  /**\n   * Method will trigger before send the request to server side.\n   * Used to set the custom header or modify the request options.\n   * @param  {DataManager} dm\n   * @param  {XMLHttpRequest} request\n   * @param  {Ajax} settings\n   * @returns void\n   */\n\n\n  WebApiAdaptor.prototype.beforeSend = function (dm, request, settings) {\n    request.setRequestHeader('Accept', 'application/json, text/javascript, */*; q=0.01');\n  };\n  /**\n   * Returns the data from the query processing.\n   * @param  {DataResult} data\n   * @param  {DataOptions} ds?\n   * @param  {Query} query?\n   * @param  {XMLHttpRequest} xhr?\n   * @param  {Ajax} request?\n   * @param  {CrudOptions} changes?\n   * @returns aggregateResult\n   */\n\n\n  WebApiAdaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n    var pvtData = 'pvtData';\n    var pvt = request && request[pvtData];\n    var count = null;\n    var args = {};\n\n    if (request && request.type.toLowerCase() !== 'post') {\n      var versionCheck = xhr && request.getResponseHeader('DataServiceVersion');\n      var version = versionCheck && parseInt(versionCheck, 10) || 2;\n\n      if (query && query.isCountRequired) {\n        if (!DataUtil.isNull(data.Count)) {\n          count = data.Count;\n        }\n      }\n\n      if (version < 3 && data.Items) {\n        data = data.Items;\n      }\n\n      args.count = count;\n      args.result = data;\n      this.getAggregateResult(pvt, data, args, null, query);\n    }\n\n    args.result = args.result || data;\n    return DataUtil.isNull(count) ? args.result : {\n      result: args.result,\n      count: args.count,\n      aggregates: args.aggregates\n    };\n  };\n\n  return WebApiAdaptor;\n}(ODataAdaptor);\n\nexport { WebApiAdaptor };\n/**\n * WebMethodAdaptor can be used by DataManager to interact with web method.\n * @hidden\n */\n\nvar WebMethodAdaptor =\n/** @class */\nfunction (_super) {\n  __extends(WebMethodAdaptor, _super);\n\n  function WebMethodAdaptor() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  /**\n   * Prepare the request body based on the query.\n   * The query information can be accessed at the WebMethod using variable named `value`.\n   * @param  {DataManager} dm\n   * @param  {Query} query\n   * @param  {Object[]} hierarchyFilters?\n   * @returns application\n   */\n\n\n  WebMethodAdaptor.prototype.processQuery = function (dm, query, hierarchyFilters) {\n    var obj = new UrlAdaptor().processQuery(dm, query, hierarchyFilters);\n    var getData = 'data';\n    var data = DataUtil.parse.parseJson(obj[getData]);\n    var result = {};\n    var value = 'value';\n\n    if (data.param) {\n      for (var i = 0; i < data.param.length; i++) {\n        var param = data.param[i];\n        var key = Object.keys(param)[0];\n        result[key] = param[key];\n      }\n    }\n\n    result[value] = data;\n    var pvtData = 'pvtData';\n    var url = 'url';\n    return {\n      data: JSON.stringify(result),\n      url: obj[url],\n      pvtData: obj[pvtData],\n      type: 'POST',\n      contentType: 'application/json; charset=utf-8'\n    };\n  };\n\n  return WebMethodAdaptor;\n}(UrlAdaptor);\n\nexport { WebMethodAdaptor };\n/**\n * RemoteSaveAdaptor, extended from JsonAdaptor and it is used for binding local data and performs all DataManager queries in client-side.\n * It interacts with server-side only for CRUD operations.\n * @hidden\n */\n\nvar RemoteSaveAdaptor =\n/** @class */\nfunction (_super) {\n  __extends(RemoteSaveAdaptor, _super);\n  /**\n   * @hidden\n   */\n\n\n  function RemoteSaveAdaptor() {\n    var _this = _super.call(this) || this;\n\n    setValue('beforeSend', UrlAdaptor.prototype.beforeSend, _this);\n    return _this;\n  }\n\n  RemoteSaveAdaptor.prototype.insert = function (dm, data, tableName, query, position) {\n    this.pvt.position = position;\n    this.updateType = 'add';\n    return {\n      url: dm.dataSource.insertUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n      data: JSON.stringify(extend({}, {\n        value: data,\n        table: tableName,\n        action: 'insert'\n      }, DataUtil.getAddParams(this, dm, query)))\n    };\n  };\n\n  RemoteSaveAdaptor.prototype.remove = function (dm, keyField, val, tableName, query) {\n    _super.prototype.remove.call(this, dm, keyField, val);\n\n    return {\n      type: 'POST',\n      url: dm.dataSource.removeUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n      data: JSON.stringify(extend({}, {\n        key: val,\n        keyColumn: keyField,\n        table: tableName,\n        action: 'remove'\n      }, DataUtil.getAddParams(this, dm, query)))\n    };\n  };\n\n  RemoteSaveAdaptor.prototype.update = function (dm, keyField, val, tableName, query) {\n    this.updateType = 'update';\n    this.updateKey = keyField;\n    return {\n      type: 'POST',\n      url: dm.dataSource.updateUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n      data: JSON.stringify(extend({}, {\n        value: val,\n        action: 'update',\n        keyColumn: keyField,\n        key: val[keyField],\n        table: tableName\n      }, DataUtil.getAddParams(this, dm, query)))\n    };\n  };\n\n  RemoteSaveAdaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes, e) {\n    var i;\n\n    if (this.updateType === 'add') {\n      _super.prototype.insert.call(this, ds, data, null, null, this.pvt.position);\n    }\n\n    if (this.updateType === 'update') {\n      _super.prototype.update.call(this, ds, this.updateKey, data);\n    }\n\n    this.updateType = undefined;\n\n    if (data.added) {\n      for (i = 0; i < data.added.length; i++) {\n        _super.prototype.insert.call(this, ds, data.added[i]);\n      }\n    }\n\n    if (data.changed) {\n      for (i = 0; i < data.changed.length; i++) {\n        _super.prototype.update.call(this, ds, e.key, data.changed[i]);\n      }\n    }\n\n    if (data.deleted) {\n      for (i = 0; i < data.deleted.length; i++) {\n        _super.prototype.remove.call(this, ds, e.key, data.deleted[i]);\n      }\n    }\n\n    return data;\n  };\n  /**\n   * Prepare the request body based on the newly added, removed and updated records.\n   * Also perform the changes in the locally cached data to sync with the remote data.\n   * The result is used by the batch request.\n   * @param  {DataManager} dm\n   * @param  {CrudOptions} changes\n   * @param  {RemoteArgs} e\n   */\n\n\n  RemoteSaveAdaptor.prototype.batchRequest = function (dm, changes, e, query, original) {\n    return {\n      type: 'POST',\n      url: dm.dataSource.batchUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n      contentType: 'application/json; charset=utf-8',\n      dataType: 'json',\n      data: JSON.stringify(extend({}, {\n        changed: changes.changedRecords,\n        added: changes.addedRecords,\n        deleted: changes.deletedRecords,\n        action: 'batch',\n        table: e.url,\n        key: e.key\n      }, DataUtil.getAddParams(this, dm, query)))\n    };\n  };\n\n  RemoteSaveAdaptor.prototype.addParams = function (options) {\n    var urlParams = new UrlAdaptor();\n    urlParams.addParams(options);\n  };\n\n  return RemoteSaveAdaptor;\n}(JsonAdaptor);\n\nexport { RemoteSaveAdaptor };\n/**\n * Cache Adaptor is used to cache the data of the visited pages. It prevents new requests for the previously visited pages.\n * You can configure cache page size and duration of caching by using cachingPageSize and timeTillExpiration properties of the DataManager\n * @hidden\n */\n\nvar CacheAdaptor =\n/** @class */\nfunction (_super) {\n  __extends(CacheAdaptor, _super);\n  /**\n   * Constructor for CacheAdaptor class.\n   * @param  {CacheAdaptor} adaptor?\n   * @param  {number} timeStamp?\n   * @param  {number} pageSize?\n   * @hidden\n   */\n\n\n  function CacheAdaptor(adaptor, timeStamp, pageSize) {\n    var _this = _super.call(this) || this;\n\n    _this.isCrudAction = false;\n    _this.isInsertAction = false;\n\n    if (!isNullOrUndefined(adaptor)) {\n      _this.cacheAdaptor = adaptor;\n    }\n\n    _this.pageSize = pageSize;\n    _this.guidId = DataUtil.getGuid('cacheAdaptor');\n    var obj = {\n      keys: [],\n      results: []\n    };\n    window.localStorage.setItem(_this.guidId, JSON.stringify(obj));\n    var guid = _this.guidId;\n\n    if (!isNullOrUndefined(timeStamp)) {\n      setInterval(function () {\n        var data;\n        data = DataUtil.parse.parseJson(window.localStorage.getItem(guid));\n        var forDel = [];\n\n        for (var i = 0; i < data.results.length; i++) {\n          var currentTime = +new Date();\n          var requestTime = +new Date(data.results[i].timeStamp);\n          data.results[i].timeStamp = currentTime - requestTime;\n\n          if (currentTime - requestTime > timeStamp) {\n            forDel.push(i);\n          }\n        }\n\n        for (var i = 0; i < forDel.length; i++) {\n          data.results.splice(forDel[i], 1);\n          data.keys.splice(forDel[i], 1);\n        }\n\n        window.localStorage.removeItem(guid);\n        window.localStorage.setItem(guid, JSON.stringify(data));\n      }, timeStamp);\n    }\n\n    return _this;\n  }\n  /**\n   * It will generate the key based on the URL when we send a request to server.\n   * @param  {string} url\n   * @param  {Query} query?\n   * @hidden\n   */\n\n\n  CacheAdaptor.prototype.generateKey = function (url, query) {\n    var queries = this.getQueryRequest(query);\n    var singles = Query.filterQueryLists(query.queries, ['onSelect', 'onPage', 'onSkip', 'onTake', 'onRange']);\n    var key = url;\n    var page = 'onPage';\n\n    if (page in singles) {\n      key += singles[page].pageIndex;\n    }\n\n    queries.sorts.forEach(function (obj) {\n      key += obj.e.direction + obj.e.fieldName;\n    });\n    queries.groups.forEach(function (obj) {\n      key += obj.e.fieldName;\n    });\n    queries.searches.forEach(function (obj) {\n      key += obj.e.searchKey;\n    });\n\n    for (var filter = 0; filter < queries.filters.length; filter++) {\n      var currentFilter = queries.filters[filter];\n\n      if (currentFilter.e.isComplex) {\n        var newQuery = query.clone();\n        newQuery.queries = [];\n\n        for (var i = 0; i < currentFilter.e.predicates.length; i++) {\n          newQuery.queries.push({\n            fn: 'onWhere',\n            e: currentFilter.e.predicates[i],\n            filter: query.queries.filter\n          });\n        }\n\n        key += currentFilter.e.condition + this.generateKey(url, newQuery);\n      } else {\n        key += currentFilter.e.field + currentFilter.e.operator + currentFilter.e.value;\n      }\n    }\n\n    return key;\n  };\n  /**\n   * Process the query to generate request body.\n   * If the data is already cached, it will return the cached data.\n   * @param  {DataManager} dm\n   * @param  {Query} query?\n   * @param  {Object[]} hierarchyFilters?\n   */\n\n\n  CacheAdaptor.prototype.processQuery = function (dm, query, hierarchyFilters) {\n    var key = this.generateKey(dm.dataSource.url, query);\n    var cachedItems;\n    cachedItems = DataUtil.parse.parseJson(window.localStorage.getItem(this.guidId));\n    var data = cachedItems ? cachedItems.results[cachedItems.keys.indexOf(key)] : null;\n\n    if (data != null && !this.isCrudAction && !this.isInsertAction) {\n      return data;\n    }\n\n    this.isCrudAction = null;\n    this.isInsertAction = null;\n    return this.cacheAdaptor.processQuery.apply(this.cacheAdaptor, [].slice.call(arguments, 0));\n  };\n  /**\n   * Returns the data from the query processing.\n   * It will also cache the data for later usage.\n   * @param  {DataResult} data\n   * @param  {DataManager} ds?\n   * @param  {Query} query?\n   * @param  {XMLHttpRequest} xhr?\n   * @param  {Ajax} request?\n   * @param  {CrudOptions} changes?\n   */\n\n\n  CacheAdaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n    if (this.isInsertAction || request && this.cacheAdaptor.options.batch && DataUtil.endsWith(request.url, this.cacheAdaptor.options.batch) && request.type.toLowerCase() === 'post') {\n      return this.cacheAdaptor.processResponse(data, ds, query, xhr, request, changes);\n    }\n\n    data = this.cacheAdaptor.processResponse.apply(this.cacheAdaptor, [].slice.call(arguments, 0));\n    var key = query ? this.generateKey(ds.dataSource.url, query) : ds.dataSource.url;\n    var obj = {};\n    obj = DataUtil.parse.parseJson(window.localStorage.getItem(this.guidId));\n    var index = obj.keys.indexOf(key);\n\n    if (index !== -1) {\n      obj.results.splice(index, 1);\n      obj.keys.splice(index, 1);\n    }\n\n    obj.results[obj.keys.push(key) - 1] = {\n      keys: key,\n      result: data.result,\n      timeStamp: new Date(),\n      count: data.count\n    };\n\n    while (obj.results.length > this.pageSize) {\n      obj.results.splice(0, 1);\n      obj.keys.splice(0, 1);\n    }\n\n    window.localStorage.setItem(this.guidId, JSON.stringify(obj));\n    return data;\n  };\n  /**\n   * Method will trigger before send the request to server side. Used to set the custom header or modify the request options.\n   * @param  {DataManager} dm\n   * @param  {XMLHttpRequest} request\n   * @param  {Ajax} settings?\n   */\n\n\n  CacheAdaptor.prototype.beforeSend = function (dm, request, settings) {\n    if (!isNullOrUndefined(this.cacheAdaptor.options.batch) && DataUtil.endsWith(settings.url, this.cacheAdaptor.options.batch) && settings.type.toLowerCase() === 'post') {\n      request.setRequestHeader('Accept', this.cacheAdaptor.options.multipartAccept);\n    }\n\n    if (!dm.dataSource.crossDomain) {\n      request.setRequestHeader('Accept', this.cacheAdaptor.options.accept);\n    }\n  };\n  /**\n   * Updates existing record and saves the changes to the table.\n   * @param  {DataManager} dm\n   * @param  {string} keyField\n   * @param  {Object} value\n   * @param  {string} tableName\n   */\n\n\n  CacheAdaptor.prototype.update = function (dm, keyField, value, tableName) {\n    this.isCrudAction = true;\n    return this.cacheAdaptor.update(dm, keyField, value, tableName);\n  };\n  /**\n   * Prepare and returns request body which is used to insert a new record in the table.\n   * @param  {DataManager} dm\n   * @param  {Object} data\n   * @param  {string} tableName?\n   */\n\n\n  CacheAdaptor.prototype.insert = function (dm, data, tableName) {\n    this.isInsertAction = true;\n    return this.cacheAdaptor.insert(dm, data, tableName);\n  };\n  /**\n   * Prepare and return request body which is used to remove record from the table.\n   * @param  {DataManager} dm\n   * @param  {string} keyField\n   * @param  {Object} value\n   * @param  {string} tableName?\n   */\n\n\n  CacheAdaptor.prototype.remove = function (dm, keyField, value, tableName) {\n    this.isCrudAction = true;\n    return this.cacheAdaptor.remove(dm, keyField, value, tableName);\n  };\n  /**\n   * Prepare the request body based on the newly added, removed and updated records.\n   * The result is used by the batch request.\n   * @param  {DataManager} dm\n   * @param  {CrudOptions} changes\n   * @param  {RemoteArgs} e\n   */\n\n\n  CacheAdaptor.prototype.batchRequest = function (dm, changes, e) {\n    return this.cacheAdaptor.batchRequest(dm, changes, e);\n  };\n\n  return CacheAdaptor;\n}(UrlAdaptor);\n\nexport { CacheAdaptor };","map":{"version":3,"sources":["/Users/gabbinguyen/Flatiron/code/Projects/LifeOfTheParty/frontend/node_modules/@syncfusion/ej2-data/src/adaptors.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","merge","extend","isNullOrUndefined","setValue","getValue","DataUtil","Query","Predicate","consts","GroupGuid","Adaptor","ds","options","from","requestType","sortBy","select","skip","group","take","search","count","where","aggregates","expand","type","dataSource","pvt","processResponse","data","query","xhr","JsonAdaptor","_super","apply","arguments","processQuery","dataManager","result","json","slice","length","countFlg","ret","key","lazyLoad","keyCount","page","i","value","agg","queries","fn","push","e","call","field","undefined","args","lazyLoadData","lazyLoadGroup","isCountRequired","getAggregate","onDemandGroupInfo","req","onWhere","level","fieldName","comparer","formGroupResult","onPage","uid","childLevel","records","aggQuery","filterQueries","tmp","batchRequest","dm","changes","deletedRecordsLen","deletedRecords","addedRecords","insert","changedRecords","update","remove","filter","obj","validate","onAggregates","onSearch","fieldNames","getFieldList","j","getObject","searchKey","ignoreCase","ignoreAccent","onSortBy","fnCompare","sort","endsWith","fnSort","replace","onGroup","size","pageSize","start","pageIndex","end","onRange","onTake","nos","onSkip","onSelect","tableName","position","splice","keyField","Date","UrlAdaptor","hierarchyFilters","getQueryRequest","singles","filterQueryLists","params","url","temp","request","sorts","groups","filters","searches","callAdaptorFunction","name","direction","getFiltersFrom","toJson","keys_3","keys","_i","keys_1","prop","isNull","fields","operator","getRequestQuery","reqParams","_a","keys_2","JSON","stringify","parse","jsonDateReplacer","pvtData","contentType","convertToQueryString","indexOf","request1","param","fromTable","distincts","selects","expands","getResponseHeader","handleTimeZone","timeZoneHandling","parseJson","requests","groupDs","action","isExpand","isArray","val","formRemoteGroupedData","getAggregateResult","items","childLvl","lvl","getGroupedRecords","hasRecords","childGroupedRecords","concat","original","batchUrl","crudUrl","removeUrl","dataType","changed","added","deleted","table","getAddParams","beforeSend","insertUrl","keyColumn","updateUrl","fKey","pKey","predicats","or","pData","aggregateData","res","aggregate","isServerGrouping","groupQuery","addParams","Error","ODataAdaptor","props","_this","accept","multipartAccept","batch","changeSet","batchPre","contentId","batchContent","changeSetContent","batchChangeSetContentType","updateType","getModuleName","onPredicate","predicate","requiresCast","returnValue","guid","getField","replacer","encodeURIComponent","isGuid","toLowerCase","odBiOperator","odv4UniOperator","odUniOperator","onComplexPredicate","predicates","onEachWhere","join","condition","isComplex","onEachSearch","throwError","onEachSort","reverse","onCount","settings","setRequestHeader","overrideMimeType","metaCheck","rootUrl","dataUrls","split","resourceTableName","dataCopy","results","metaData","emptyAndBatch","processBatchResponse","versionCheck","version","parseInt","oDataCount","format","requiresFormat","keys_4","localTimeReplacer","convertObj","dateParse","toLocalTime","localTime","compareAndRemove","initialGuid","getGuid","cid","cSet","generateInsertRequest","generateUpdateRequest","generateDeleteRequest","arr","stat","dateTime","toJSON","generateBodyContent","org","forEach","change","o","date","method","cIdx","jsonObj","substring","exVal","exec","changeGuid","test","isPlainObject","final","valueOf","ODataV4Adaptor","isDate","onExpand","selected","expanded","exArr","item","splits","ex","onDistinct","distinctFields","map","metaName","dataUrl","dataCount","WebApiAdaptor","_loop_1","x","location","host","_loop_2","_loop_3","state","datTime","Count","Items","WebMethodAdaptor","getData","RemoteSaveAdaptor","updateKey","urlParams","CacheAdaptor","adaptor","timeStamp","isCrudAction","isInsertAction","cacheAdaptor","guidId","window","localStorage","setItem","setInterval","getItem","forDel","currentTime","requestTime","removeItem","generateKey","currentFilter","newQuery","clone","cachedItems","index","crossDomain"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { merge, extend, isNullOrUndefined, setValue, getValue } from '@syncfusion/ej2-base';\nimport { DataUtil } from './util';\nimport { Query, Predicate } from './query';\nvar consts = { GroupGuid: '{271bbba0-1ee7}' };\n/**\n * Adaptors are specific data source type aware interfaces that are used by DataManager to communicate with DataSource.\n * This is the base adaptor class that other adaptors can extend.\n * @hidden\n */\nvar Adaptor = /** @class */ (function () {\n    /**\n     * Constructor for Adaptor class\n     * @param  {DataOptions} ds?\n     * @hidden\n     * @returns aggregates\n     */\n    function Adaptor(ds) {\n        // common options for all the adaptors \n        this.options = {\n            from: 'table',\n            requestType: 'json',\n            sortBy: 'sorted',\n            select: 'select',\n            skip: 'skip',\n            group: 'group',\n            take: 'take',\n            search: 'search',\n            count: 'requiresCounts',\n            where: 'where',\n            aggregates: 'aggregates',\n            expand: 'expand'\n        };\n        /**\n         * Specifies the type of adaptor.\n         * @default Adaptor\n         */\n        this.type = Adaptor;\n        this.dataSource = ds;\n        this.pvt = {};\n    }\n    /**\n     * Returns the data from the query processing.\n     * @param  {Object} data\n     * @param  {DataOptions} ds?\n     * @param  {Query} query?\n     * @param  {XMLHttpRequest} xhr?\n     * @returns Object\n     */\n    Adaptor.prototype.processResponse = function (data, ds, query, xhr) {\n        return data;\n    };\n    return Adaptor;\n}());\nexport { Adaptor };\n/**\n * JsonAdaptor is used to process JSON data. It contains methods to process the given JSON data based on the queries.\n * @hidden\n */\nvar JsonAdaptor = /** @class */ (function (_super) {\n    __extends(JsonAdaptor, _super);\n    function JsonAdaptor() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     * Process the JSON data based on the provided queries.\n     * @param  {DataManager} dataManager\n     * @param  {Query} query\n     * @returns Object\n     */\n    JsonAdaptor.prototype.processQuery = function (dataManager, query) {\n        var result = dataManager.dataSource.json.slice(0);\n        var count = result.length;\n        var countFlg = true;\n        var ret;\n        var key;\n        var lazyLoad = {};\n        var keyCount = 0;\n        var group = [];\n        var page;\n        for (var i = 0; i < query.lazyLoad.length; i++) {\n            keyCount++;\n            lazyLoad[query.lazyLoad[i].key] = query.lazyLoad[i].value;\n        }\n        var agg = {};\n        for (var i = 0; i < query.queries.length; i++) {\n            key = query.queries[i];\n            if ((key.fn === 'onPage' || key.fn === 'onGroup') && query.lazyLoad.length) {\n                if (key.fn === 'onGroup') {\n                    group.push(key.e);\n                }\n                if (key.fn === 'onPage') {\n                    page = key.e;\n                }\n                continue;\n            }\n            ret = this[key.fn].call(this, result, key.e, query);\n            if (key.fn === 'onAggregates') {\n                agg[key.e.field + ' - ' + key.e.type] = ret;\n            }\n            else {\n                result = ret !== undefined ? ret : result;\n            }\n            if (key.fn === 'onPage' || key.fn === 'onSkip' || key.fn === 'onTake' || key.fn === 'onRange') {\n                countFlg = false;\n            }\n            if (countFlg) {\n                count = result.length;\n            }\n        }\n        if (keyCount) {\n            var args = {\n                query: query, lazyLoad: lazyLoad, result: result, group: group, page: page\n            };\n            var lazyLoadData = this.lazyLoadGroup(args);\n            result = lazyLoadData.result;\n            count = lazyLoadData.count;\n        }\n        if (query.isCountRequired) {\n            result = {\n                result: result,\n                count: count,\n                aggregates: agg\n            };\n        }\n        return result;\n    };\n    /**\n     * Perform lazy load grouping in JSON array based on the given query and lazy load details.\n     * @param  {LazyLoadGroupArgs} args\n     */\n    JsonAdaptor.prototype.lazyLoadGroup = function (args) {\n        var count = 0;\n        var agg = this.getAggregate(args.query);\n        var result = args.result;\n        if (!isNullOrUndefined(args.lazyLoad.onDemandGroupInfo)) {\n            var req = args.lazyLoad.onDemandGroupInfo;\n            for (var i = req.where.length - 1; i >= 0; i--) {\n                result = this.onWhere(result, req.where[i]);\n            }\n            if (args.group.length !== req.level) {\n                var field = args.group[req.level].fieldName;\n                result = DataUtil.group(result, field, agg, null, null, args.group[0].comparer, true);\n            }\n            count = result.length;\n            var data = result;\n            result = result.slice(req.skip);\n            result = result.slice(0, req.take);\n            if (args.group.length !== req.level) {\n                this.formGroupResult(result, data);\n            }\n        }\n        else {\n            var field = args.group[0].fieldName;\n            result = DataUtil.group(result, field, agg, null, null, args.group[0].comparer, true);\n            count = result.length;\n            var data = result;\n            if (args.page) {\n                result = this.onPage(result, args.page, args.query);\n            }\n            this.formGroupResult(result, data);\n        }\n        return { result: result, count: count };\n    };\n    JsonAdaptor.prototype.formGroupResult = function (result, data) {\n        if (result.length && data.length) {\n            var uid = 'GroupGuid';\n            var childLevel = 'childLevels';\n            var level = 'level';\n            var records = 'records';\n            result[uid] = data[uid];\n            result[childLevel] = data[childLevel];\n            result[level] = data[level];\n            result[records] = data[records];\n        }\n        return result;\n    };\n    /**\n     * Separate the aggregate query from the given queries\n     * @param  {Query} query\n     */\n    JsonAdaptor.prototype.getAggregate = function (query) {\n        var aggQuery = Query.filterQueries(query.queries, 'onAggregates');\n        var agg = [];\n        if (aggQuery.length) {\n            var tmp = void 0;\n            for (var i = 0; i < aggQuery.length; i++) {\n                tmp = aggQuery[i].e;\n                agg.push({ type: tmp.type, field: DataUtil.getValue(tmp.field, query) });\n            }\n        }\n        return agg;\n    };\n    /**\n     * Performs batch update in the JSON array which add, remove and update records.\n     * @param  {DataManager} dm\n     * @param  {CrudOptions} changes\n     * @param  {RemoteArgs} e\n     */\n    JsonAdaptor.prototype.batchRequest = function (dm, changes, e) {\n        var i;\n        var deletedRecordsLen = changes.deletedRecords.length;\n        for (i = 0; i < changes.addedRecords.length; i++) {\n            this.insert(dm, changes.addedRecords[i]);\n        }\n        for (i = 0; i < changes.changedRecords.length; i++) {\n            this.update(dm, e.key, changes.changedRecords[i]);\n        }\n        for (i = 0; i < deletedRecordsLen; i++) {\n            this.remove(dm, e.key, changes.deletedRecords[i]);\n        }\n        return changes;\n    };\n    /**\n     * Performs filter operation with the given data and where query.\n     * @param  {Object[]} ds\n     * @param  {{validate:Function}} e\n     */\n    JsonAdaptor.prototype.onWhere = function (ds, e) {\n        if (!ds || !ds.length) {\n            return ds;\n        }\n        return ds.filter(function (obj) {\n            if (e) {\n                return e.validate(obj);\n            }\n        });\n    };\n    /**\n     * Returns aggregate function based on the aggregate type.\n     * @param  {Object[]} ds\n     * @param  {{field:string} e\n     * @param  {string}} type\n     */\n    JsonAdaptor.prototype.onAggregates = function (ds, e) {\n        var fn = DataUtil.aggregates[e.type];\n        if (!ds || !fn || ds.length === 0) {\n            return null;\n        }\n        return fn(ds, e.field);\n    };\n    /**\n     * Performs search operation based on the given query.\n     * @param  {Object[]} ds\n     * @param  {QueryOptions} e\n     */\n    JsonAdaptor.prototype.onSearch = function (ds, e) {\n        if (!ds || !ds.length) {\n            return ds;\n        }\n        if (e.fieldNames.length === 0) {\n            DataUtil.getFieldList(ds[0], e.fieldNames);\n        }\n        return ds.filter(function (obj) {\n            for (var j = 0; j < e.fieldNames.length; j++) {\n                if (e.comparer.call(obj, DataUtil.getObject(e.fieldNames[j], obj), e.searchKey, e.ignoreCase, e.ignoreAccent)) {\n                    return true;\n                }\n            }\n            return false;\n        });\n    };\n    /**\n     * Sort the data with given direction and field.\n     * @param  {Object[]} ds\n     * @param  {{comparer:(a:Object} e\n     * @param  {Object} b\n     */\n    JsonAdaptor.prototype.onSortBy = function (ds, e, query) {\n        if (!ds || !ds.length) {\n            return ds;\n        }\n        var fnCompare;\n        var field = DataUtil.getValue(e.fieldName, query);\n        if (!field) {\n            return ds.sort(e.comparer);\n        }\n        if (field instanceof Array) {\n            field = field.slice(0);\n            for (var i = field.length - 1; i >= 0; i--) {\n                if (!field[i]) {\n                    continue;\n                }\n                fnCompare = e.comparer;\n                if (DataUtil.endsWith(field[i], ' desc')) {\n                    fnCompare = DataUtil.fnSort('descending');\n                    field[i] = field[i].replace(' desc', '');\n                }\n                ds = DataUtil.sort(ds, field[i], fnCompare);\n            }\n            return ds;\n        }\n        return DataUtil.sort(ds, field, e.comparer);\n    };\n    /**\n     * Group the data based on the given query.\n     * @param  {Object[]} ds\n     * @param  {QueryOptions} e\n     * @param  {Query} query\n     */\n    JsonAdaptor.prototype.onGroup = function (ds, e, query) {\n        if (!ds || !ds.length) {\n            return ds;\n        }\n        var agg = this.getAggregate(query);\n        return DataUtil.group(ds, DataUtil.getValue(e.fieldName, query), agg, null, null, e.comparer);\n    };\n    /**\n     * Retrieves records based on the given page index and size.\n     * @param  {Object[]} ds\n     * @param  {{pageSize:number} e\n     * @param  {number}} pageIndex\n     * @param  {Query} query\n     */\n    JsonAdaptor.prototype.onPage = function (ds, e, query) {\n        var size = DataUtil.getValue(e.pageSize, query);\n        var start = (DataUtil.getValue(e.pageIndex, query) - 1) * size;\n        var end = start + size;\n        if (!ds || !ds.length) {\n            return ds;\n        }\n        return ds.slice(start, end);\n    };\n    /**\n     * Retrieves records based on the given start and end index from query.\n     * @param  {Object[]} ds\n     * @param  {{start:number} e\n     * @param  {number}} end\n     */\n    JsonAdaptor.prototype.onRange = function (ds, e) {\n        if (!ds || !ds.length) {\n            return ds;\n        }\n        return ds.slice(DataUtil.getValue(e.start), DataUtil.getValue(e.end));\n    };\n    /**\n     * Picks the given count of records from the top of the datasource.\n     * @param  {Object[]} ds\n     * @param  {{nos:number}} e\n     */\n    JsonAdaptor.prototype.onTake = function (ds, e) {\n        if (!ds || !ds.length) {\n            return ds;\n        }\n        return ds.slice(0, DataUtil.getValue(e.nos));\n    };\n    /**\n     * Skips the given count of records from the data source.\n     * @param  {Object[]} ds\n     * @param  {{nos:number}} e\n     */\n    JsonAdaptor.prototype.onSkip = function (ds, e) {\n        if (!ds || !ds.length) {\n            return ds;\n        }\n        return ds.slice(DataUtil.getValue(e.nos));\n    };\n    /**\n     * Selects specified columns from the data source.\n     * @param  {Object[]} ds\n     * @param  {{fieldNames:string}} e\n     */\n    JsonAdaptor.prototype.onSelect = function (ds, e) {\n        if (!ds || !ds.length) {\n            return ds;\n        }\n        return DataUtil.select(ds, DataUtil.getValue(e.fieldNames));\n    };\n    /**\n     * Inserts new record in the table.\n     * @param  {DataManager} dm\n     * @param  {Object} data\n     * @param  {number} position\n     */\n    JsonAdaptor.prototype.insert = function (dm, data, tableName, query, position) {\n        if (isNullOrUndefined(position)) {\n            return dm.dataSource.json.push(data);\n        }\n        else {\n            return dm.dataSource.json.splice(position, 0, data);\n        }\n    };\n    /**\n     * Remove the data from the dataSource based on the key field value.\n     * @param  {DataManager} dm\n     * @param  {string} keyField\n     * @param  {Object} value\n     * @param  {string} tableName?\n     * @returns null\n     */\n    JsonAdaptor.prototype.remove = function (dm, keyField, value, tableName) {\n        var ds = dm.dataSource.json;\n        var i;\n        if (typeof value === 'object' && !(value instanceof Date)) {\n            value = DataUtil.getObject(keyField, value);\n        }\n        for (i = 0; i < ds.length; i++) {\n            if (DataUtil.getObject(keyField, ds[i]) === value) {\n                break;\n            }\n        }\n        return i !== ds.length ? ds.splice(i, 1) : null;\n    };\n    /**\n     * Updates existing record and saves the changes to the table.\n     * @param  {DataManager} dm\n     * @param  {string} keyField\n     * @param  {Object} value\n     * @param  {string} tableName?\n     * @returns null\n     */\n    JsonAdaptor.prototype.update = function (dm, keyField, value, tableName) {\n        var ds = dm.dataSource.json;\n        var i;\n        var key;\n        if (!isNullOrUndefined(keyField)) {\n            key = getValue(keyField, value);\n        }\n        for (i = 0; i < ds.length; i++) {\n            if (!isNullOrUndefined(keyField) && (getValue(keyField, ds[i])) === key) {\n                break;\n            }\n        }\n        return i < ds.length ? merge(ds[i], value) : null;\n    };\n    return JsonAdaptor;\n}(Adaptor));\nexport { JsonAdaptor };\n/**\n * URL Adaptor of DataManager can be used when you are required to use remote service to retrieve data.\n * It interacts with server-side for all DataManager Queries and CRUD operations.\n * @hidden\n */\nvar UrlAdaptor = /** @class */ (function (_super) {\n    __extends(UrlAdaptor, _super);\n    function UrlAdaptor() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     * Process the query to generate request body.\n     * @param  {DataManager} dm\n     * @param  {Query} query\n     * @param  {Object[]} hierarchyFilters?\n     * @returns p\n     */\n    // tslint:disable-next-line:max-func-body-length\n    UrlAdaptor.prototype.processQuery = function (dm, query, hierarchyFilters) {\n        var queries = this.getQueryRequest(query);\n        var singles = Query.filterQueryLists(query.queries, ['onSelect', 'onPage', 'onSkip', 'onTake', 'onRange']);\n        var params = query.params;\n        var url = dm.dataSource.url;\n        var temp;\n        var skip;\n        var take = null;\n        var options = this.options;\n        var request = { sorts: [], groups: [], filters: [], searches: [], aggregates: [] };\n        // calc Paging & Range\n        if ('onPage' in singles) {\n            temp = singles.onPage;\n            skip = DataUtil.getValue(temp.pageIndex, query);\n            take = DataUtil.getValue(temp.pageSize, query);\n            skip = (skip - 1) * take;\n        }\n        else if ('onRange' in singles) {\n            temp = singles.onRange;\n            skip = temp.start;\n            take = temp.end - temp.start;\n        }\n        // Sorting\n        for (var i = 0; i < queries.sorts.length; i++) {\n            temp = DataUtil.getValue(queries.sorts[i].e.fieldName, query);\n            request.sorts.push(DataUtil.callAdaptorFunction(this, 'onEachSort', { name: temp, direction: queries.sorts[i].e.direction }, query));\n        }\n        // hierarchy\n        if (hierarchyFilters) {\n            temp = this.getFiltersFrom(hierarchyFilters, query);\n            if (temp) {\n                request.filters.push(DataUtil.callAdaptorFunction(this, 'onEachWhere', temp.toJson(), query));\n            }\n        }\n        // Filters\n        for (var i = 0; i < queries.filters.length; i++) {\n            request.filters.push(DataUtil.callAdaptorFunction(this, 'onEachWhere', queries.filters[i].e.toJson(), query));\n            var keys_3 = typeof request.filters[i] === 'object' ? Object.keys(request.filters[i]) : [];\n            for (var _i = 0, keys_1 = keys_3; _i < keys_1.length; _i++) {\n                var prop = keys_1[_i];\n                if (DataUtil.isNull((request)[prop])) {\n                    delete request[prop];\n                }\n            }\n        }\n        // Searches\n        for (var i = 0; i < queries.searches.length; i++) {\n            temp = queries.searches[i].e;\n            request.searches.push(DataUtil.callAdaptorFunction(this, 'onEachSearch', {\n                fields: temp.fieldNames,\n                operator: temp.operator,\n                key: temp.searchKey,\n                ignoreCase: temp.ignoreCase\n            }, query));\n        }\n        // Grouping\n        for (var i = 0; i < queries.groups.length; i++) {\n            request.groups.push(DataUtil.getValue(queries.groups[i].e.fieldName, query));\n        }\n        // aggregates\n        for (var i = 0; i < queries.aggregates.length; i++) {\n            temp = queries.aggregates[i].e;\n            request.aggregates.push({ type: temp.type, field: DataUtil.getValue(temp.field, query) });\n        }\n        var req = {};\n        this.getRequestQuery(options, query, singles, request, req);\n        // Params\n        DataUtil.callAdaptorFunction(this, 'addParams', { dm: dm, query: query, params: params, reqParams: req });\n        if (query.lazyLoad.length) {\n            for (var i = 0; i < query.lazyLoad.length; i++) {\n                req[query.lazyLoad[i].key] = query.lazyLoad[i].value;\n            }\n        }\n        // cleanup\n        var keys = Object.keys(req);\n        for (var _a = 0, keys_2 = keys; _a < keys_2.length; _a++) {\n            var prop = keys_2[_a];\n            if (DataUtil.isNull(req[prop]) || req[prop] === '' || req[prop].length === 0) {\n                delete req[prop];\n            }\n        }\n        if (!(options.skip in req && options.take in req) && take !== null) {\n            req[options.skip] = DataUtil.callAdaptorFunction(this, 'onSkip', skip, query);\n            req[options.take] = DataUtil.callAdaptorFunction(this, 'onTake', take, query);\n        }\n        var p = this.pvt;\n        this.pvt = {};\n        if (this.options.requestType === 'json') {\n            return {\n                data: JSON.stringify(req, DataUtil.parse.jsonDateReplacer),\n                url: url,\n                pvtData: p,\n                type: 'POST',\n                contentType: 'application/json; charset=utf-8'\n            };\n        }\n        temp = this.convertToQueryString(req, query, dm);\n        temp = (dm.dataSource.url.indexOf('?') !== -1 ? '&' : '/') + temp;\n        return {\n            type: 'GET', url: temp.length ? url.replace(/\\/*$/, temp) : url, pvtData: p\n        };\n    };\n    UrlAdaptor.prototype.getRequestQuery = function (options, query, singles, request, request1) {\n        var param = 'param';\n        var req = request1;\n        req[options.from] = query.fromTable;\n        if (options.apply && query.distincts.length) {\n            req[options.apply] = 'onDistinct' in this ? DataUtil.callAdaptorFunction(this, 'onDistinct', query.distincts) : '';\n        }\n        if (!query.distincts.length && options.expand) {\n            req[options.expand] = 'onExpand' in this && 'onSelect' in singles ?\n                DataUtil.callAdaptorFunction(this, 'onExpand', { selects: DataUtil.getValue(singles.onSelect.fieldNames, query), expands: query.expands }, query) : query.expands;\n        }\n        req[options.select] = 'onSelect' in singles && !query.distincts.length ?\n            DataUtil.callAdaptorFunction(this, 'onSelect', DataUtil.getValue(singles.onSelect.fieldNames, query), query) : '';\n        req[options.count] = query.isCountRequired ? DataUtil.callAdaptorFunction(this, 'onCount', query.isCountRequired, query) : '';\n        req[options.search] = request.searches.length ? DataUtil.callAdaptorFunction(this, 'onSearch', request.searches, query) : '';\n        req[options.skip] = 'onSkip' in singles ?\n            DataUtil.callAdaptorFunction(this, 'onSkip', DataUtil.getValue(singles.onSkip.nos, query), query) : '';\n        req[options.take] = 'onTake' in singles ?\n            DataUtil.callAdaptorFunction(this, 'onTake', DataUtil.getValue(singles.onTake.nos, query), query) : '';\n        req[options.where] = request.filters.length || request.searches.length ?\n            DataUtil.callAdaptorFunction(this, 'onWhere', request.filters, query) : '';\n        req[options.sortBy] = request.sorts.length ? DataUtil.callAdaptorFunction(this, 'onSortBy', request.sorts, query) : '';\n        req[options.group] = request.groups.length ? DataUtil.callAdaptorFunction(this, 'onGroup', request.groups, query) : '';\n        req[options.aggregates] = request.aggregates.length ?\n            DataUtil.callAdaptorFunction(this, 'onAggregates', request.aggregates, query) : '';\n        req[param] = [];\n    };\n    /**\n     * Convert the object from processQuery to string which can be added query string.\n     * @param  {Object} req\n     * @param  {Query} query\n     * @param  {DataManager} dm\n     */\n    UrlAdaptor.prototype.convertToQueryString = function (request, query, dm) {\n        return '';\n        // this needs to be overridden\n    };\n    /**\n     * Return the data from the data manager processing.\n     * @param  {DataResult} data\n     * @param  {DataOptions} ds?\n     * @param  {Query} query?\n     * @param  {XMLHttpRequest} xhr?\n     * @param  {Object} request?\n     * @param  {CrudOptions} changes?\n     */\n    UrlAdaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n        if (xhr && xhr.getResponseHeader('Content-Type') &&\n            xhr.getResponseHeader('Content-Type').indexOf('application/json') !== -1) {\n            var handleTimeZone = DataUtil.timeZoneHandling;\n            if (ds && !ds.timeZoneHandling) {\n                DataUtil.timeZoneHandling = false;\n            }\n            data = DataUtil.parse.parseJson(data);\n            DataUtil.timeZoneHandling = handleTimeZone;\n        }\n        var requests = request;\n        var pvt = requests.pvtData || {};\n        var groupDs = data ? data.groupDs : [];\n        if (xhr && xhr.getResponseHeader('Content-Type') &&\n            xhr.getResponseHeader('Content-Type').indexOf('xml') !== -1) {\n            return (query.isCountRequired ? { result: [], count: 0 } : []);\n        }\n        var d = JSON.parse(requests.data);\n        if (d && d.action === 'batch' && data && data.addedRecords) {\n            changes.addedRecords = data.addedRecords;\n            return changes;\n        }\n        if (data && data.d) {\n            data = data.d;\n        }\n        var args = {};\n        if (data && 'count' in data) {\n            args.count = data.count;\n        }\n        args.result = data && data.result ? data.result : data;\n        var isExpand = false;\n        if (Array.isArray(data.result) && data.result.length) {\n            var key = 'key';\n            var val = 'value';\n            var level = 'level';\n            if (!isNullOrUndefined(data.result[0][key])) {\n                args.result = this.formRemoteGroupedData(args.result, 1, pvt.groups.length - 1);\n            }\n            if (query && query.lazyLoad.length && pvt.groups.length) {\n                for (var i = 0; i < query.lazyLoad.length; i++) {\n                    if (query.lazyLoad[i][key] === 'onDemandGroupInfo') {\n                        var value = query.lazyLoad[i][val][level];\n                        if (pvt.groups.length === value) {\n                            isExpand = true;\n                        }\n                    }\n                }\n            }\n        }\n        if (!isExpand) {\n            this.getAggregateResult(pvt, data, args, groupDs, query);\n        }\n        return DataUtil.isNull(args.count) ? args.result : { result: args.result, count: args.count, aggregates: args.aggregates };\n    };\n    UrlAdaptor.prototype.formRemoteGroupedData = function (data, level, childLevel) {\n        for (var i = 0; i < data.length; i++) {\n            if (data[i].items.length && Object.keys(data[i].items[0]).indexOf('key') > -1) {\n                this.formRemoteGroupedData(data[i].items, level + 1, childLevel - 1);\n            }\n        }\n        var uid = 'GroupGuid';\n        var childLvl = 'childLevels';\n        var lvl = 'level';\n        var records = 'records';\n        data[uid] = consts[uid];\n        data[lvl] = level;\n        data[childLvl] = childLevel;\n        data[records] = data[0].items.length ? this.getGroupedRecords(data, !isNullOrUndefined(data[0].items[records])) : [];\n        return data;\n    };\n    UrlAdaptor.prototype.getGroupedRecords = function (data, hasRecords) {\n        var childGroupedRecords = [];\n        var records = 'records';\n        for (var i = 0; i < data.length; i++) {\n            if (!hasRecords) {\n                for (var j = 0; j < data[i].items.length; j++) {\n                    childGroupedRecords.push(data[i].items[j]);\n                }\n            }\n            else {\n                childGroupedRecords = childGroupedRecords.concat(data[i].items[records]);\n            }\n        }\n        return childGroupedRecords;\n    };\n    /**\n     * Add the group query to the adaptor`s option.\n     * @param  {Object[]} e\n     * @returns void\n     */\n    UrlAdaptor.prototype.onGroup = function (e) {\n        this.pvt.groups = e;\n        return e;\n    };\n    /**\n     * Add the aggregate query to the adaptor`s option.\n     * @param  {Aggregates[]} e\n     * @returns void\n     */\n    UrlAdaptor.prototype.onAggregates = function (e) {\n        this.pvt.aggregates = e;\n    };\n    /**\n     * Prepare the request body based on the newly added, removed and updated records.\n     * The result is used by the batch request.\n     * @param  {DataManager} dm\n     * @param  {CrudOptions} changes\n     * @param  {Object} e\n     */\n    UrlAdaptor.prototype.batchRequest = function (dm, changes, e, query, original) {\n        var url;\n        var key;\n        return {\n            type: 'POST',\n            url: dm.dataSource.batchUrl || dm.dataSource.crudUrl || dm.dataSource.removeUrl || dm.dataSource.url,\n            contentType: 'application/json; charset=utf-8',\n            dataType: 'json',\n            data: JSON.stringify(extend({}, {\n                changed: changes.changedRecords,\n                added: changes.addedRecords,\n                deleted: changes.deletedRecords,\n                action: 'batch',\n                table: e[url],\n                key: e[key]\n            }, DataUtil.getAddParams(this, dm, query)))\n        };\n    };\n    /**\n     * Method will trigger before send the request to server side.\n     * Used to set the custom header or modify the request options.\n     * @param  {DataManager} dm\n     * @param  {XMLHttpRequest} request\n     * @returns void\n     */\n    UrlAdaptor.prototype.beforeSend = function (dm, request) {\n        // need to extend this method\n    };\n    /**\n     * Prepare and returns request body which is used to insert a new record in the table.\n     * @param  {DataManager} dm\n     * @param  {Object} data\n     * @param  {string} tableName\n     */\n    UrlAdaptor.prototype.insert = function (dm, data, tableName, query) {\n        return {\n            url: dm.dataSource.insertUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n            data: JSON.stringify(extend({}, {\n                value: data,\n                table: tableName,\n                action: 'insert'\n            }, DataUtil.getAddParams(this, dm, query)))\n        };\n    };\n    /**\n     * Prepare and return request body which is used to remove record from the table.\n     * @param  {DataManager} dm\n     * @param  {string} keyField\n     * @param  {number|string} value\n     * @param  {string} tableName\n     */\n    UrlAdaptor.prototype.remove = function (dm, keyField, value, tableName, query) {\n        return {\n            type: 'POST',\n            url: dm.dataSource.removeUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n            data: JSON.stringify(extend({}, {\n                key: value,\n                keyColumn: keyField,\n                table: tableName,\n                action: 'remove'\n            }, DataUtil.getAddParams(this, dm, query)))\n        };\n    };\n    /**\n     * Prepare and return request body which is used to update record.\n     * @param  {DataManager} dm\n     * @param  {string} keyField\n     * @param  {Object} value\n     * @param  {string} tableName\n     */\n    UrlAdaptor.prototype.update = function (dm, keyField, value, tableName, query) {\n        return {\n            type: 'POST',\n            url: dm.dataSource.updateUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n            data: JSON.stringify(extend({}, {\n                value: value,\n                action: 'update',\n                keyColumn: keyField,\n                key: DataUtil.getObject(keyField, value),\n                table: tableName\n            }, DataUtil.getAddParams(this, dm, query)))\n        };\n    };\n    /**\n     * To generate the predicate based on the filtered query.\n     * @param  {Object[]|string[]|number[]} data\n     * @param  {Query} query\n     * @hidden\n     */\n    UrlAdaptor.prototype.getFiltersFrom = function (data, query) {\n        var key = query.fKey;\n        var value;\n        var prop = key;\n        var pKey = query.key;\n        var predicats = [];\n        if (typeof data[0] !== 'object') {\n            prop = null;\n        }\n        for (var i = 0; i < data.length; i++) {\n            if (typeof data[0] === 'object') {\n                value = DataUtil.getObject(pKey || prop, data[i]);\n            }\n            else {\n                value = data[i];\n            }\n            predicats.push(new Predicate(key, 'equal', value));\n        }\n        return Predicate.or(predicats);\n    };\n    UrlAdaptor.prototype.getAggregateResult = function (pvt, data, args, groupDs, query) {\n        var pData = data;\n        if (data && data.result) {\n            pData = data.result;\n        }\n        if (pvt && pvt.aggregates && pvt.aggregates.length) {\n            var agg = pvt.aggregates;\n            var fn = void 0;\n            var aggregateData = pData;\n            var res = {};\n            if (data.aggregate) {\n                aggregateData = data.aggregate;\n            }\n            for (var i = 0; i < agg.length; i++) {\n                fn = DataUtil.aggregates[agg[i].type];\n                if (fn) {\n                    res[agg[i].field + ' - ' + agg[i].type] = fn(aggregateData, agg[i].field);\n                }\n            }\n            args.aggregates = res;\n        }\n        var key = 'key';\n        var isServerGrouping = Array.isArray(data.result) && data.result.length && !isNullOrUndefined(data.result[0][key]);\n        if (pvt && pvt.groups && pvt.groups.length && !isServerGrouping) {\n            var groups = pvt.groups;\n            for (var i = 0; i < groups.length; i++) {\n                var level = null;\n                if (!isNullOrUndefined(groupDs)) {\n                    groupDs = DataUtil.group(groupDs, groups[i]);\n                }\n                var groupQuery = Query.filterQueries(query.queries, 'onGroup')[i].e;\n                pData = DataUtil.group(pData, groups[i], pvt.aggregates, level, groupDs, groupQuery.comparer);\n            }\n            args.result = pData;\n        }\n        return args;\n    };\n    UrlAdaptor.prototype.getQueryRequest = function (query) {\n        var req = { sorts: [], groups: [], filters: [], searches: [], aggregates: [] };\n        req.sorts = Query.filterQueries(query.queries, 'onSortBy');\n        req.groups = Query.filterQueries(query.queries, 'onGroup');\n        req.filters = Query.filterQueries(query.queries, 'onWhere');\n        req.searches = Query.filterQueries(query.queries, 'onSearch');\n        req.aggregates = Query.filterQueries(query.queries, 'onAggregates');\n        return req;\n    };\n    UrlAdaptor.prototype.addParams = function (options) {\n        var req = options.reqParams;\n        if (options.params.length) {\n            req.params = {};\n        }\n        for (var _i = 0, _a = options.params; _i < _a.length; _i++) {\n            var tmp = _a[_i];\n            if (req[tmp.key]) {\n                throw new Error('Query() - addParams: Custom Param is conflicting other request arguments');\n            }\n            req[tmp.key] = tmp.value;\n            if (tmp.fn) {\n                req[tmp.key] = tmp.fn.call(options.query, tmp.key, options.query, options.dm);\n            }\n            req.params[tmp.key] = req[tmp.key];\n        }\n    };\n    return UrlAdaptor;\n}(Adaptor));\nexport { UrlAdaptor };\n/**\n * OData Adaptor that is extended from URL Adaptor, is used for consuming data through OData Service.\n * @hidden\n */\nvar ODataAdaptor = /** @class */ (function (_super) {\n    __extends(ODataAdaptor, _super);\n    function ODataAdaptor(props) {\n        var _this = _super.call(this) || this;\n        // options replaced the default adaptor options\n        _this.options = extend({}, _this.options, {\n            requestType: 'get',\n            accept: 'application/json;odata=light;q=1,application/json;odata=verbose;q=0.5',\n            multipartAccept: 'multipart/mixed',\n            sortBy: '$orderby',\n            select: '$select',\n            skip: '$skip',\n            take: '$top',\n            count: '$inlinecount',\n            where: '$filter',\n            expand: '$expand',\n            batch: '$batch',\n            changeSet: '--changeset_',\n            batchPre: 'batch_',\n            contentId: 'Content-Id: ',\n            batchContent: 'Content-Type: multipart/mixed; boundary=',\n            changeSetContent: 'Content-Type: application/http\\nContent-Transfer-Encoding: binary ',\n            batchChangeSetContentType: 'Content-Type: application/json; charset=utf-8 ',\n            updateType: 'PUT'\n        });\n        extend(_this.options, props || {});\n        return _this;\n    }\n    ODataAdaptor.prototype.getModuleName = function () {\n        return 'ODataAdaptor';\n    };\n    /**\n     * Generate request string based on the filter criteria from query.\n     * @param  {Predicate} pred\n     * @param  {boolean} requiresCast?\n     */\n    ODataAdaptor.prototype.onPredicate = function (predicate, query, requiresCast) {\n        var returnValue = '';\n        var operator;\n        var guid;\n        var val = predicate.value;\n        var type = typeof val;\n        var field = predicate.field ? ODataAdaptor.getField(predicate.field) : null;\n        if (val instanceof Date) {\n            val = 'datetime\\'' + DataUtil.parse.replacer(val) + '\\'';\n        }\n        if (type === 'string') {\n            val = encodeURIComponent(val);\n            val = '\\'' + val + '\\'';\n            if (requiresCast) {\n                field = 'cast(' + field + ', \\'Edm.String\\')';\n            }\n            if (DataUtil.parse.isGuid(val)) {\n                guid = 'guid';\n            }\n            if (predicate.ignoreCase) {\n                if (!guid) {\n                    field = 'tolower(' + field + ')';\n                }\n                val = val.toLowerCase();\n            }\n        }\n        operator = DataUtil.odBiOperator[predicate.operator];\n        if (operator) {\n            returnValue += field;\n            returnValue += operator;\n            if (guid) {\n                returnValue += guid;\n            }\n            return returnValue + val;\n        }\n        if (!isNullOrUndefined(this.getModuleName) && this.getModuleName() === 'ODataV4Adaptor') {\n            operator = DataUtil.odv4UniOperator[predicate.operator];\n        }\n        else {\n            operator = DataUtil.odUniOperator[predicate.operator];\n        }\n        if (operator === 'substringof') {\n            var temp = val;\n            val = field;\n            field = temp;\n        }\n        returnValue += operator + '(';\n        returnValue += field + ',';\n        if (guid) {\n            returnValue += guid;\n        }\n        returnValue += val + ')';\n        return returnValue;\n    };\n    ODataAdaptor.prototype.addParams = function (options) {\n        _super.prototype.addParams.call(this, options);\n        delete options.reqParams.params;\n    };\n    /**\n     * Generate request string based on the multiple filter criteria from query.\n     * @param  {Predicate} pred\n     * @param  {boolean} requiresCast?\n     */\n    ODataAdaptor.prototype.onComplexPredicate = function (predicate, query, requiresCast) {\n        var res = [];\n        for (var i = 0; i < predicate.predicates.length; i++) {\n            res.push('(' + this.onEachWhere(predicate.predicates[i], query, requiresCast) + ')');\n        }\n        return res.join(' ' + predicate.condition + ' ');\n    };\n    /**\n     * Generate query string based on the multiple filter criteria from query.\n     * @param  {Predicate} filter\n     * @param  {boolean} requiresCast?\n     */\n    ODataAdaptor.prototype.onEachWhere = function (filter, query, requiresCast) {\n        return filter.isComplex ? this.onComplexPredicate(filter, query, requiresCast) : this.onPredicate(filter, query, requiresCast);\n    };\n    /**\n     * Generate query string based on the multiple filter criteria from query.\n     * @param  {string[]} filters\n     */\n    ODataAdaptor.prototype.onWhere = function (filters) {\n        if (this.pvt.search) {\n            filters.push(this.onEachWhere(this.pvt.search, null, true));\n        }\n        return filters.join(' and ');\n    };\n    /**\n     * Generate query string based on the multiple search criteria from query.\n     * @param  {{fields:string[]} e\n     * @param  {string} operator\n     * @param  {string} key\n     * @param  {boolean}} ignoreCase\n     */\n    ODataAdaptor.prototype.onEachSearch = function (e) {\n        if (e.fields && e.fields.length === 0) {\n            DataUtil.throwError('Query() - Search : oData search requires list of field names to search');\n        }\n        var filter = this.pvt.search || [];\n        for (var i = 0; i < e.fields.length; i++) {\n            filter.push(new Predicate(e.fields[i], e.operator, e.key, e.ignoreCase));\n        }\n        this.pvt.search = filter;\n    };\n    /**\n     * Generate query string based on the search criteria from query.\n     * @param  {Object} e\n     */\n    ODataAdaptor.prototype.onSearch = function (e) {\n        this.pvt.search = Predicate.or(this.pvt.search);\n        return '';\n    };\n    /**\n     * Generate query string based on multiple sort criteria from query.\n     * @param  {QueryOptions} e\n     */\n    ODataAdaptor.prototype.onEachSort = function (e) {\n        var res = [];\n        if (e.name instanceof Array) {\n            for (var i = 0; i < e.name.length; i++) {\n                res.push(ODataAdaptor.getField(e.name[i]) + (e.direction === 'descending' ? ' desc' : ''));\n            }\n        }\n        else {\n            res.push(ODataAdaptor.getField(e.name) + (e.direction === 'descending' ? ' desc' : ''));\n        }\n        return res.join(',');\n    };\n    /**\n     * Returns sort query string.\n     * @param  {string[]} e\n     */\n    ODataAdaptor.prototype.onSortBy = function (e) {\n        return e.reverse().join(',');\n    };\n    /**\n     * Adds the group query to the adaptor option.\n     * @param  {Object[]} e\n     * @returns string\n     */\n    ODataAdaptor.prototype.onGroup = function (e) {\n        this.pvt.groups = e;\n        return [];\n    };\n    /**\n     * Returns the select query string.\n     * @param  {string[]} e\n     */\n    ODataAdaptor.prototype.onSelect = function (e) {\n        for (var i = 0; i < e.length; i++) {\n            e[i] = ODataAdaptor.getField(e[i]);\n        }\n        return e.join(',');\n    };\n    /**\n     * Add the aggregate query to the adaptor option.\n     * @param  {Object[]} e\n     * @returns string\n     */\n    ODataAdaptor.prototype.onAggregates = function (e) {\n        this.pvt.aggregates = e;\n        return '';\n    };\n    /**\n     * Returns the query string which requests total count from the data source.\n     * @param  {boolean} e\n     * @returns string\n     */\n    ODataAdaptor.prototype.onCount = function (e) {\n        return e === true ? 'allpages' : '';\n    };\n    /**\n     * Method will trigger before send the request to server side.\n     * Used to set the custom header or modify the request options.\n     * @param  {DataManager} dm\n     * @param  {XMLHttpRequest} request\n     * @param  {Ajax} settings?\n     */\n    ODataAdaptor.prototype.beforeSend = function (dm, request, settings) {\n        if (DataUtil.endsWith(settings.url, this.options.batch) && settings.type.toLowerCase() === 'post') {\n            request.setRequestHeader('Accept', this.options.multipartAccept);\n            request.setRequestHeader('DataServiceVersion', '2.0');\n            request.overrideMimeType('text/plain; charset=x-user-defined');\n        }\n        else {\n            request.setRequestHeader('Accept', this.options.accept);\n        }\n        request.setRequestHeader('DataServiceVersion', '2.0');\n        request.setRequestHeader('MaxDataServiceVersion', '2.0');\n    };\n    /**\n     * Returns the data from the query processing.\n     * @param  {DataResult} data\n     * @param  {DataOptions} ds?\n     * @param  {Query} query?\n     * @param  {XMLHttpRequest} xhr?\n     * @param  {Ajax} request?\n     * @param  {CrudOptions} changes?\n     * @returns aggregateResult\n     */\n    ODataAdaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n        var metaCheck = 'odata.metadata';\n        if ((request && request.type === 'GET') && !this.rootUrl && data[metaCheck]) {\n            var dataUrls = data[metaCheck].split('/$metadata#');\n            this.rootUrl = dataUrls[0];\n            this.resourceTableName = dataUrls[1];\n        }\n        var pvtData = 'pvtData';\n        if (!isNullOrUndefined(data.d)) {\n            var dataCopy = ((query && query.isCountRequired) ? data.d.results : data.d);\n            var metaData = '__metadata';\n            if (!isNullOrUndefined(dataCopy)) {\n                for (var i = 0; i < dataCopy.length; i++) {\n                    if (!isNullOrUndefined(dataCopy[i][metaData])) {\n                        delete dataCopy[i][metaData];\n                    }\n                }\n            }\n        }\n        var pvt = request && request[pvtData];\n        var emptyAndBatch = this.processBatchResponse(data, query, xhr, request, changes);\n        if (emptyAndBatch) {\n            return emptyAndBatch;\n        }\n        var versionCheck = xhr && request.getResponseHeader('DataServiceVersion');\n        var count = null;\n        var version = (versionCheck && parseInt(versionCheck, 10)) || 2;\n        if (query && query.isCountRequired) {\n            var oDataCount = '__count';\n            if (data[oDataCount] || data['odata.count']) {\n                count = data[oDataCount] || data['odata.count'];\n            }\n            if (data.d) {\n                data = data.d;\n            }\n            if (data[oDataCount] || data['odata.count']) {\n                count = data[oDataCount] || data['odata.count'];\n            }\n        }\n        if (version === 3 && data.value) {\n            data = data.value;\n        }\n        if (data.d) {\n            data = data.d;\n        }\n        if (version < 3 && data.results) {\n            data = data.results;\n        }\n        var args = {};\n        args.count = count;\n        args.result = data;\n        this.getAggregateResult(pvt, data, args, null, query);\n        return DataUtil.isNull(count) ? args.result : { result: args.result, count: args.count, aggregates: args.aggregates };\n    };\n    /**\n     * Converts the request object to query string.\n     * @param  {Object} req\n     * @param  {Query} query\n     * @param  {DataManager} dm\n     * @returns tableName\n     */\n    ODataAdaptor.prototype.convertToQueryString = function (request, query, dm) {\n        var res = [];\n        var table = 'table';\n        var tableName = request[table] || '';\n        var format = '$format';\n        delete request[table];\n        if (dm.dataSource.requiresFormat) {\n            request[format] = 'json';\n        }\n        var keys = Object.keys(request);\n        for (var _i = 0, keys_4 = keys; _i < keys_4.length; _i++) {\n            var prop = keys_4[_i];\n            res.push(prop + '=' + request[prop]);\n        }\n        res = res.join('&');\n        if (dm.dataSource.url && dm.dataSource.url.indexOf('?') !== -1 && !tableName) {\n            return res;\n        }\n        return res.length ? tableName + '?' + res : tableName || '';\n    };\n    ODataAdaptor.prototype.localTimeReplacer = function (key, convertObj) {\n        for (var _i = 0, _a = !isNullOrUndefined(convertObj) ? Object.keys(convertObj) : []; _i < _a.length; _i++) {\n            var prop = _a[_i];\n            if ((convertObj[prop] instanceof Date)) {\n                convertObj[prop] = DataUtil.dateParse.toLocalTime(convertObj[prop]);\n            }\n        }\n        return convertObj;\n    };\n    /**\n     * Prepare and returns request body which is used to insert a new record in the table.\n     * @param  {DataManager} dm\n     * @param  {Object} data\n     * @param  {string} tableName?\n     */\n    ODataAdaptor.prototype.insert = function (dm, data, tableName) {\n        return {\n            url: (dm.dataSource.insertUrl || dm.dataSource.url).replace(/\\/*$/, tableName ? '/' + tableName : ''),\n            data: JSON.stringify(data, this.options.localTime ? this.localTimeReplacer : null)\n        };\n    };\n    /**\n     * Prepare and return request body which is used to remove record from the table.\n     * @param  {DataManager} dm\n     * @param  {string} keyField\n     * @param  {number} value\n     * @param  {string} tableName?\n     */\n    ODataAdaptor.prototype.remove = function (dm, keyField, value, tableName) {\n        var url;\n        if (typeof value === 'string' && !DataUtil.parse.isGuid(value)) {\n            url = \"('\" + value + \"')\";\n        }\n        else {\n            url = \"(\" + value + \")\";\n        }\n        return {\n            type: 'DELETE',\n            url: (dm.dataSource.removeUrl || dm.dataSource.url).replace(/\\/*$/, tableName ? '/' + tableName : '') + url\n        };\n    };\n    /**\n     * Updates existing record and saves the changes to the table.\n     * @param  {DataManager} dm\n     * @param  {string} keyField\n     * @param  {Object} value\n     * @param  {string} tableName?\n     * @returns this\n     */\n    ODataAdaptor.prototype.update = function (dm, keyField, value, tableName, query, original) {\n        if (this.options.updateType === 'PATCH' && !isNullOrUndefined(original)) {\n            value = this.compareAndRemove(value, original, keyField);\n        }\n        var url;\n        if (typeof value[keyField] === 'string' && !DataUtil.parse.isGuid(value[keyField])) {\n            url = \"('\" + value[keyField] + \"')\";\n        }\n        else {\n            url = \"(\" + value[keyField] + \")\";\n        }\n        return {\n            type: this.options.updateType,\n            url: (dm.dataSource.updateUrl || dm.dataSource.url).replace(/\\/*$/, tableName ? '/' + tableName : '') + url,\n            data: JSON.stringify(value, this.options.localTime ? this.localTimeReplacer : null),\n            accept: this.options.accept\n        };\n    };\n    /**\n     * Prepare the request body based on the newly added, removed and updated records.\n     * The result is used by the batch request.\n     * @param  {DataManager} dm\n     * @param  {CrudOptions} changes\n     * @param  {RemoteArgs} e\n     * @returns {Object}\n     */\n    ODataAdaptor.prototype.batchRequest = function (dm, changes, e, query, original) {\n        var initialGuid = e.guid = DataUtil.getGuid(this.options.batchPre);\n        var url = this.rootUrl ? this.rootUrl + '/' + this.options.batch :\n            dm.dataSource.url.replace(/\\/*$/, '/' + this.options.batch);\n        e.url = this.resourceTableName ? this.resourceTableName : e.url;\n        var args = {\n            url: e.url,\n            key: e.key,\n            cid: 1,\n            cSet: DataUtil.getGuid(this.options.changeSet)\n        };\n        var req = '--' + initialGuid + '\\n';\n        req += 'Content-Type: multipart/mixed; boundary=' + args.cSet.replace('--', '') + '\\n';\n        this.pvt.changeSet = 0;\n        req += this.generateInsertRequest(changes.addedRecords, args, dm);\n        req += this.generateUpdateRequest(changes.changedRecords, args, dm, original ? original.changedRecords : []);\n        req += this.generateDeleteRequest(changes.deletedRecords, args, dm);\n        req += args.cSet + '--\\n';\n        req += '--' + initialGuid + '--';\n        return {\n            type: 'POST',\n            url: url,\n            dataType: 'json',\n            contentType: 'multipart/mixed; charset=UTF-8;boundary=' + initialGuid,\n            data: req\n        };\n    };\n    /**\n     * Generate the string content from the removed records.\n     * The result will be send during batch update.\n     * @param  {Object[]} arr\n     * @param  {RemoteArgs} e\n     * @returns this\n     */\n    ODataAdaptor.prototype.generateDeleteRequest = function (arr, e, dm) {\n        if (!arr) {\n            return '';\n        }\n        var req = '';\n        var stat = {\n            'method': 'DELETE ',\n            'url': function (data, i, key) {\n                var url = DataUtil.getObject(key, data[i]);\n                if (typeof url === 'number' || DataUtil.parse.isGuid(url)) {\n                    return '(' + url + ')';\n                }\n                else if (url instanceof Date) {\n                    var dateTime = data[i][key];\n                    return '(' + dateTime.toJSON() + ')';\n                }\n                else {\n                    return \"('\" + url + \"')\";\n                }\n            },\n            'data': function (data, i) { return ''; }\n        };\n        req = this.generateBodyContent(arr, e, stat, dm);\n        return req + '\\n';\n    };\n    /**\n     * Generate the string content from the inserted records.\n     * The result will be send during batch update.\n     * @param  {Object[]} arr\n     * @param  {RemoteArgs} e\n     */\n    ODataAdaptor.prototype.generateInsertRequest = function (arr, e, dm) {\n        if (!arr) {\n            return '';\n        }\n        var req = '';\n        var stat = {\n            'method': 'POST ',\n            'url': function (data, i, key) { return ''; },\n            'data': function (data, i) { return JSON.stringify(data[i]) + '\\n\\n'; }\n        };\n        req = this.generateBodyContent(arr, e, stat, dm);\n        return req;\n    };\n    /**\n     * Generate the string content from the updated records.\n     * The result will be send during batch update.\n     * @param  {Object[]} arr\n     * @param  {RemoteArgs} e\n     */\n    ODataAdaptor.prototype.generateUpdateRequest = function (arr, e, dm, org) {\n        var _this = this;\n        if (!arr) {\n            return '';\n        }\n        var req = '';\n        arr.forEach(function (change) { return change = _this.compareAndRemove(change, org.filter(function (o) { return DataUtil.getObject(e.key, o) === DataUtil.getObject(e.key, change); })[0], e.key); });\n        var stat = {\n            'method': this.options.updateType + ' ',\n            'url': function (data, i, key) {\n                if (typeof data[i][key] === 'number' || DataUtil.parse.isGuid(data[i][key])) {\n                    return '(' + data[i][key] + ')';\n                }\n                else if (data[i][key] instanceof Date) {\n                    var date = data[i][key];\n                    return '(' + date.toJSON() + ')';\n                }\n                else {\n                    return \"('\" + data[i][key] + \"')\";\n                }\n            },\n            'data': function (data, i) { return JSON.stringify(data[i]) + '\\n\\n'; }\n        };\n        req = this.generateBodyContent(arr, e, stat, dm);\n        return req;\n    };\n    ODataAdaptor.getField = function (prop) {\n        return prop.replace(/\\./g, '/');\n    };\n    ODataAdaptor.prototype.generateBodyContent = function (arr, e, stat, dm) {\n        var req = '';\n        for (var i = 0; i < arr.length; i++) {\n            req += '\\n' + e.cSet + '\\n';\n            req += this.options.changeSetContent + '\\n\\n';\n            req += stat.method;\n            if (stat.method === 'POST ') {\n                req += (dm.dataSource.insertUrl || dm.dataSource.crudUrl || e.url) + stat.url(arr, i, e.key) + ' HTTP/1.1\\n';\n            }\n            else if (stat.method === 'PUT ' || stat.method === 'PATCH ') {\n                req += (dm.dataSource.updateUrl || dm.dataSource.crudUrl || e.url) + stat.url(arr, i, e.key) + ' HTTP/1.1\\n';\n            }\n            else if (stat.method === 'DELETE ') {\n                req += (dm.dataSource.removeUrl || dm.dataSource.crudUrl || e.url) + stat.url(arr, i, e.key) + ' HTTP/1.1\\n';\n            }\n            req += 'Accept: ' + this.options.accept + '\\n';\n            req += 'Content-Id: ' + this.pvt.changeSet++ + '\\n';\n            req += this.options.batchChangeSetContentType + '\\n';\n            if (!isNullOrUndefined(arr[i]['@odata.etag'])) {\n                req += 'If-Match: ' + arr[i]['@odata.etag'] + '\\n\\n';\n                delete arr[i]['@odata.etag'];\n            }\n            else {\n                req += '\\n';\n            }\n            req += stat.data(arr, i);\n        }\n        return req;\n    };\n    ODataAdaptor.prototype.processBatchResponse = function (data, query, xhr, request, changes) {\n        if (xhr && xhr.getResponseHeader('Content-Type') && xhr.getResponseHeader('Content-Type').indexOf('xml') !== -1) {\n            return (query.isCountRequired ? { result: [], count: 0 } : []);\n        }\n        if (request && this.options.batch && DataUtil.endsWith(request.url, this.options.batch) && request.type.toLowerCase() === 'post') {\n            var guid = xhr.getResponseHeader('Content-Type');\n            var cIdx = void 0;\n            var jsonObj = void 0;\n            var d = data + '';\n            guid = guid.substring(guid.indexOf('=batchresponse') + 1);\n            d = d.split(guid);\n            if (d.length < 2) {\n                return {};\n            }\n            d = d[1];\n            var exVal = /(?:\\bContent-Type.+boundary=)(changesetresponse.+)/i.exec(d);\n            if (exVal) {\n                d.replace(exVal[0], '');\n            }\n            var changeGuid = exVal ? exVal[1] : '';\n            d = d.split(changeGuid);\n            for (var i = d.length; i > -1; i--) {\n                if (!/\\bContent-ID:/i.test(d[i]) || !/\\bHTTP.+201/.test(d[i])) {\n                    continue;\n                }\n                cIdx = parseInt(/\\bContent-ID: (\\d+)/i.exec(d[i])[1], 10);\n                if (changes.addedRecords[cIdx]) {\n                    jsonObj = DataUtil.parse.parseJson(/^\\{.+\\}/m.exec(d[i])[0]);\n                    extend({}, changes.addedRecords[cIdx], this.processResponse(jsonObj));\n                }\n            }\n            return changes;\n        }\n        return null;\n    };\n    ODataAdaptor.prototype.compareAndRemove = function (data, original, key) {\n        var _this = this;\n        if (isNullOrUndefined(original)) {\n            return data;\n        }\n        Object.keys(data).forEach(function (prop) {\n            if (prop !== key && prop !== '@odata.etag') {\n                if (DataUtil.isPlainObject(data[prop])) {\n                    _this.compareAndRemove(data[prop], original[prop]);\n                    var final = Object.keys(data[prop]).filter(function (data) { return data !== '@odata.etag'; });\n                    if (final.length === 0) {\n                        delete data[prop];\n                    }\n                }\n                else if (data[prop] === original[prop]) {\n                    delete data[prop];\n                }\n                else if (data[prop] && original[prop] && data[prop].valueOf() === original[prop].valueOf()) {\n                    delete data[prop];\n                }\n            }\n        });\n        return data;\n    };\n    return ODataAdaptor;\n}(UrlAdaptor));\nexport { ODataAdaptor };\n/**\n * The OData v4 is an improved version of OData protocols.\n * The DataManager uses the ODataV4Adaptor to consume OData v4 services.\n * @hidden\n */\nvar ODataV4Adaptor = /** @class */ (function (_super) {\n    __extends(ODataV4Adaptor, _super);\n    function ODataV4Adaptor(props) {\n        var _this = _super.call(this, props) || this;\n        // options replaced the default adaptor options\n        _this.options = extend({}, _this.options, {\n            requestType: 'get',\n            accept: 'application/json, text/javascript, */*; q=0.01',\n            multipartAccept: 'multipart/mixed',\n            sortBy: '$orderby',\n            select: '$select',\n            skip: '$skip',\n            take: '$top',\n            count: '$count',\n            search: '$search',\n            where: '$filter',\n            expand: '$expand',\n            batch: '$batch',\n            changeSet: '--changeset_',\n            batchPre: 'batch_',\n            contentId: 'Content-Id: ',\n            batchContent: 'Content-Type: multipart/mixed; boundary=',\n            changeSetContent: 'Content-Type: application/http\\nContent-Transfer-Encoding: binary ',\n            batchChangeSetContentType: 'Content-Type: application/json; charset=utf-8 ',\n            updateType: 'PATCH',\n            localTime: false,\n            apply: '$apply'\n        });\n        extend(_this.options, props || {});\n        return _this;\n    }\n    /**\n     * @hidden\n     */\n    ODataV4Adaptor.prototype.getModuleName = function () {\n        return 'ODataV4Adaptor';\n    };\n    /**\n     * Returns the query string which requests total count from the data source.\n     * @param  {boolean} e\n     * @returns string\n     */\n    ODataV4Adaptor.prototype.onCount = function (e) {\n        return e === true ? 'true' : '';\n    };\n    /**\n     * Generate request string based on the filter criteria from query.\n     * @param  {Predicate} pred\n     * @param  {boolean} requiresCast?\n     */\n    ODataV4Adaptor.prototype.onPredicate = function (predicate, query, requiresCast) {\n        var returnValue = '';\n        var val = predicate.value;\n        var isDate = val instanceof Date;\n        if (query instanceof Query) {\n            var queries = this.getQueryRequest(query);\n            for (var i = 0; i < queries.filters.length; i++) {\n                if (queries.filters[i].e.key === predicate.value) {\n                    requiresCast = true;\n                }\n            }\n        }\n        returnValue = _super.prototype.onPredicate.call(this, predicate, query, requiresCast);\n        if (isDate) {\n            returnValue = returnValue.replace(/datetime'(.*)'$/, '$1');\n        }\n        if (DataUtil.parse.isGuid(val)) {\n            returnValue = returnValue.replace('guid', '').replace(/'/g, '');\n        }\n        return returnValue;\n    };\n    /**\n     *  Generate query string based on the multiple search criteria from query.\n     * @param  {{fields:string[]} e\n     * @param  {string} operator\n     * @param  {string} key\n     * @param  {boolean}} ignoreCase\n     */\n    ODataV4Adaptor.prototype.onEachSearch = function (e) {\n        var search = this.pvt.searches || [];\n        search.push(e.key);\n        this.pvt.searches = search;\n    };\n    /**\n     *  Generate query string based on the search criteria from query.\n     * @param  {Object} e\n     */\n    ODataV4Adaptor.prototype.onSearch = function (e) {\n        return this.pvt.searches.join(' OR ');\n    };\n    /**\n     * Returns the expand query string.\n     * @param  {string} e\n     */\n    ODataV4Adaptor.prototype.onExpand = function (e) {\n        var _this = this;\n        var selected = {};\n        var expanded = {};\n        var expands = e.expands.slice();\n        var exArr = [];\n        var selects = e.selects.filter(function (item) { return item.indexOf('.') > -1; });\n        selects.forEach(function (select) {\n            var splits = select.split('.');\n            if (!(splits[0] in selected)) {\n                selected[splits[0]] = [];\n            }\n            selected[splits[0]].push(splits[1]);\n        });\n        //Auto expand from select query\n        Object.keys(selected).forEach(function (expand) {\n            if ((expands.indexOf(expand) === -1)) {\n                expands.push(expand);\n            }\n        });\n        expands.forEach(function (expand) {\n            expanded[expand] = expand in selected ? expand + \"(\" + _this.options.select + \"=\" + selected[expand].join(',') + \")\" : expand;\n        });\n        Object.keys(expanded).forEach(function (ex) { return exArr.push(expanded[ex]); });\n        return exArr.join(',');\n    };\n    /**\n     * Returns the groupby query string.\n     * @param  {string} e\n     */\n    ODataV4Adaptor.prototype.onDistinct = function (distinctFields) {\n        var fields = distinctFields.map(function (field) { return ODataAdaptor.getField(field); }).join(',');\n        return \"groupby((\" + fields + \"))\";\n    };\n    /**\n     * Returns the select query string.\n     * @param  {string[]} e\n     */\n    ODataV4Adaptor.prototype.onSelect = function (e) {\n        return _super.prototype.onSelect.call(this, e.filter(function (item) { return item.indexOf('.') === -1; }));\n    };\n    /**\n     * Method will trigger before send the request to server side.\n     * Used to set the custom header or modify the request options.\n     * @param  {DataManager} dm\n     * @param  {XMLHttpRequest} request\n     * @param  {Ajax} settings\n     * @returns void\n     */\n    ODataV4Adaptor.prototype.beforeSend = function (dm, request, settings) {\n        if (settings.type === 'POST' || settings.type === 'PUT' || settings.type === 'PATCH') {\n            request.setRequestHeader('Prefer', 'return=representation');\n        }\n        request.setRequestHeader('Accept', this.options.accept);\n    };\n    /**\n     * Returns the data from the query processing.\n     * @param  {DataResult} data\n     * @param  {DataOptions} ds?\n     * @param  {Query} query?\n     * @param  {XMLHttpRequest} xhr?\n     * @param  {Ajax} request?\n     * @param  {CrudOptions} changes?\n     * @returns aggregateResult\n     */\n    ODataV4Adaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n        var metaName = '@odata.context';\n        if ((request && request.type === 'GET') && !this.rootUrl && data[metaName]) {\n            var dataUrl = data[metaName].split('/$metadata#');\n            this.rootUrl = dataUrl[0];\n            this.resourceTableName = dataUrl[1];\n        }\n        var pvtData = 'pvtData';\n        var pvt = request && request[pvtData];\n        var emptyAndBatch = _super.prototype.processBatchResponse.call(this, data, query, xhr, request, changes);\n        if (emptyAndBatch) {\n            return emptyAndBatch;\n        }\n        var count = null;\n        var dataCount = '@odata.count';\n        if (query && query.isCountRequired) {\n            if (dataCount in data) {\n                count = data[dataCount];\n            }\n        }\n        data = !isNullOrUndefined(data.value) ? data.value : data;\n        var args = {};\n        args.count = count;\n        args.result = data;\n        this.getAggregateResult(pvt, data, args, null, query);\n        return DataUtil.isNull(count) ? args.result : { result: args.result, count: count, aggregates: args.aggregates };\n    };\n    return ODataV4Adaptor;\n}(ODataAdaptor));\nexport { ODataV4Adaptor };\n/**\n * The Web API is a programmatic interface to define the request and response messages system that is mostly exposed in JSON or XML.\n * The DataManager uses the WebApiAdaptor to consume Web API.\n * Since this adaptor is targeted to interact with Web API created using OData endpoint, it is extended from ODataAdaptor\n * @hidden\n */\nvar WebApiAdaptor = /** @class */ (function (_super) {\n    __extends(WebApiAdaptor, _super);\n    function WebApiAdaptor() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    WebApiAdaptor.prototype.getModuleName = function () {\n        return 'WebApiAdaptor';\n    };\n    /**\n     * Prepare and returns request body which is used to insert a new record in the table.\n     * @param  {DataManager} dm\n     * @param  {Object} data\n     * @param  {string} tableName?\n     */\n    WebApiAdaptor.prototype.insert = function (dm, data, tableName) {\n        return {\n            type: 'POST',\n            url: dm.dataSource.url,\n            data: JSON.stringify(data)\n        };\n    };\n    /**\n     * Prepare and return request body which is used to remove record from the table.\n     * @param  {DataManager} dm\n     * @param  {string} keyField\n     * @param  {number} value\n     * @param  {string} tableName?\n     */\n    WebApiAdaptor.prototype.remove = function (dm, keyField, value, tableName) {\n        return {\n            type: 'DELETE',\n            url: dm.dataSource.url + '/' + value,\n            data: JSON.stringify(value)\n        };\n    };\n    /**\n     * Prepare and return request body which is used to update record.\n     * @param  {DataManager} dm\n     * @param  {string} keyField\n     * @param  {Object} value\n     * @param  {string} tableName?\n     */\n    WebApiAdaptor.prototype.update = function (dm, keyField, value, tableName) {\n        return {\n            type: 'PUT',\n            url: dm.dataSource.url,\n            data: JSON.stringify(value)\n        };\n    };\n    WebApiAdaptor.prototype.batchRequest = function (dm, changes, e) {\n        var _this = this;\n        var initialGuid = e.guid = DataUtil.getGuid(this.options.batchPre);\n        var url = dm.dataSource.url.replace(/\\/*$/, '/' + this.options.batch);\n        e.url = this.resourceTableName ? this.resourceTableName : e.url;\n        var req = [];\n        var _loop_1 = function (i, x) {\n            changes.addedRecords.forEach(function (j, d) {\n                var stat = {\n                    'method': 'POST ',\n                    'url': function (data, i, key) { return ''; },\n                    'data': function (data, i) { return JSON.stringify(data[i]) + '\\n\\n'; }\n                };\n                req.push('--' + initialGuid);\n                req.push('Content-Type: application/http; msgtype=request', '');\n                req.push('POST ' + '/api/' + (dm.dataSource.insertUrl || dm.dataSource.crudUrl || e.url)\n                    + stat.url(changes.addedRecords, i, e.key) + ' HTTP/1.1');\n                req.push('Content-Type: ' + 'application/json; charset=utf-8');\n                req.push('Host: ' + location.host);\n                req.push('', j ? JSON.stringify(j) : '');\n            });\n        };\n        //insertion\n        for (var i = 0, x = changes.addedRecords.length; i < x; i++) {\n            _loop_1(i, x);\n        }\n        var _loop_2 = function (i, x) {\n            changes.changedRecords.forEach(function (j, d) {\n                var stat = {\n                    'method': _this.options.updateType + ' ',\n                    'url': function (data, i, key) { return ''; },\n                    'data': function (data, i) { return JSON.stringify(data[i]) + '\\n\\n'; }\n                };\n                req.push('--' + initialGuid);\n                req.push('Content-Type: application/http; msgtype=request', '');\n                req.push('PUT ' + '/api/' + (dm.dataSource.updateUrl || dm.dataSource.crudUrl || e.url)\n                    + stat.url(changes.changedRecords, i, e.key) + ' HTTP/1.1');\n                req.push('Content-Type: ' + 'application/json; charset=utf-8');\n                req.push('Host: ' + location.host);\n                req.push('', j ? JSON.stringify(j) : '');\n            });\n        };\n        //updation \n        for (var i = 0, x = changes.changedRecords.length; i < x; i++) {\n            _loop_2(i, x);\n        }\n        var _loop_3 = function (i, x) {\n            changes.deletedRecords.forEach(function (j, d) {\n                var state = {\n                    'mtd': 'DELETE ',\n                    'url': function (data, i, key) {\n                        var url = DataUtil.getObject(key, data[i]);\n                        if (typeof url === 'number' || DataUtil.parse.isGuid(url)) {\n                            return '/' + url;\n                        }\n                        else if (url instanceof Date) {\n                            var datTime = data[i][key];\n                            return '/' + datTime.toJSON();\n                        }\n                        else {\n                            return \"/'\" + url + \"'\";\n                        }\n                    },\n                    'data': function (data, i) { return ''; }\n                };\n                req.push('--' + initialGuid);\n                req.push('Content-Type: application/http; msgtype=request', '');\n                req.push('DELETE ' + '/api/' + (dm.dataSource.removeUrl || dm.dataSource.crudUrl || e.url)\n                    + state.url(changes.deletedRecords, i, e.key) + ' HTTP/1.1');\n                req.push('Content-Type: ' + 'application/json; charset=utf-8');\n                req.push('Host: ' + location.host);\n                req.push('', j ? JSON.stringify(j) : '');\n            });\n        };\n        //deletion\n        for (var i = 0, x = changes.deletedRecords.length; i < x; i++) {\n            _loop_3(i, x);\n        }\n        req.push('--' + initialGuid + '--', '');\n        return {\n            type: 'POST',\n            url: url,\n            contentType: 'multipart/mixed; boundary=' + initialGuid,\n            data: req.join('\\r\\n')\n        };\n    };\n    /**\n     * Method will trigger before send the request to server side.\n     * Used to set the custom header or modify the request options.\n     * @param  {DataManager} dm\n     * @param  {XMLHttpRequest} request\n     * @param  {Ajax} settings\n     * @returns void\n     */\n    WebApiAdaptor.prototype.beforeSend = function (dm, request, settings) {\n        request.setRequestHeader('Accept', 'application/json, text/javascript, */*; q=0.01');\n    };\n    /**\n     * Returns the data from the query processing.\n     * @param  {DataResult} data\n     * @param  {DataOptions} ds?\n     * @param  {Query} query?\n     * @param  {XMLHttpRequest} xhr?\n     * @param  {Ajax} request?\n     * @param  {CrudOptions} changes?\n     * @returns aggregateResult\n     */\n    WebApiAdaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n        var pvtData = 'pvtData';\n        var pvt = request && request[pvtData];\n        var count = null;\n        var args = {};\n        if (request && request.type.toLowerCase() !== 'post') {\n            var versionCheck = xhr && request.getResponseHeader('DataServiceVersion');\n            var version = (versionCheck && parseInt(versionCheck, 10)) || 2;\n            if (query && query.isCountRequired) {\n                if (!DataUtil.isNull(data.Count)) {\n                    count = data.Count;\n                }\n            }\n            if (version < 3 && data.Items) {\n                data = data.Items;\n            }\n            args.count = count;\n            args.result = data;\n            this.getAggregateResult(pvt, data, args, null, query);\n        }\n        args.result = args.result || data;\n        return DataUtil.isNull(count) ? args.result : { result: args.result, count: args.count, aggregates: args.aggregates };\n    };\n    return WebApiAdaptor;\n}(ODataAdaptor));\nexport { WebApiAdaptor };\n/**\n * WebMethodAdaptor can be used by DataManager to interact with web method.\n * @hidden\n */\nvar WebMethodAdaptor = /** @class */ (function (_super) {\n    __extends(WebMethodAdaptor, _super);\n    function WebMethodAdaptor() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     * Prepare the request body based on the query.\n     * The query information can be accessed at the WebMethod using variable named `value`.\n     * @param  {DataManager} dm\n     * @param  {Query} query\n     * @param  {Object[]} hierarchyFilters?\n     * @returns application\n     */\n    WebMethodAdaptor.prototype.processQuery = function (dm, query, hierarchyFilters) {\n        var obj = new UrlAdaptor().processQuery(dm, query, hierarchyFilters);\n        var getData = 'data';\n        var data = DataUtil.parse.parseJson(obj[getData]);\n        var result = {};\n        var value = 'value';\n        if (data.param) {\n            for (var i = 0; i < data.param.length; i++) {\n                var param = data.param[i];\n                var key = Object.keys(param)[0];\n                result[key] = param[key];\n            }\n        }\n        result[value] = data;\n        var pvtData = 'pvtData';\n        var url = 'url';\n        return {\n            data: JSON.stringify(result),\n            url: obj[url],\n            pvtData: obj[pvtData],\n            type: 'POST',\n            contentType: 'application/json; charset=utf-8'\n        };\n    };\n    return WebMethodAdaptor;\n}(UrlAdaptor));\nexport { WebMethodAdaptor };\n/**\n * RemoteSaveAdaptor, extended from JsonAdaptor and it is used for binding local data and performs all DataManager queries in client-side.\n * It interacts with server-side only for CRUD operations.\n * @hidden\n */\nvar RemoteSaveAdaptor = /** @class */ (function (_super) {\n    __extends(RemoteSaveAdaptor, _super);\n    /**\n     * @hidden\n     */\n    function RemoteSaveAdaptor() {\n        var _this = _super.call(this) || this;\n        setValue('beforeSend', UrlAdaptor.prototype.beforeSend, _this);\n        return _this;\n    }\n    RemoteSaveAdaptor.prototype.insert = function (dm, data, tableName, query, position) {\n        this.pvt.position = position;\n        this.updateType = 'add';\n        return {\n            url: dm.dataSource.insertUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n            data: JSON.stringify(extend({}, {\n                value: data,\n                table: tableName,\n                action: 'insert'\n            }, DataUtil.getAddParams(this, dm, query)))\n        };\n    };\n    RemoteSaveAdaptor.prototype.remove = function (dm, keyField, val, tableName, query) {\n        _super.prototype.remove.call(this, dm, keyField, val);\n        return {\n            type: 'POST',\n            url: dm.dataSource.removeUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n            data: JSON.stringify(extend({}, {\n                key: val,\n                keyColumn: keyField,\n                table: tableName,\n                action: 'remove'\n            }, DataUtil.getAddParams(this, dm, query)))\n        };\n    };\n    RemoteSaveAdaptor.prototype.update = function (dm, keyField, val, tableName, query) {\n        this.updateType = 'update';\n        this.updateKey = keyField;\n        return {\n            type: 'POST',\n            url: dm.dataSource.updateUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n            data: JSON.stringify(extend({}, {\n                value: val,\n                action: 'update',\n                keyColumn: keyField,\n                key: val[keyField],\n                table: tableName\n            }, DataUtil.getAddParams(this, dm, query)))\n        };\n    };\n    RemoteSaveAdaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes, e) {\n        var i;\n        if (this.updateType === 'add') {\n            _super.prototype.insert.call(this, ds, data, null, null, this.pvt.position);\n        }\n        if (this.updateType === 'update') {\n            _super.prototype.update.call(this, ds, this.updateKey, data);\n        }\n        this.updateType = undefined;\n        if (data.added) {\n            for (i = 0; i < data.added.length; i++) {\n                _super.prototype.insert.call(this, ds, data.added[i]);\n            }\n        }\n        if (data.changed) {\n            for (i = 0; i < data.changed.length; i++) {\n                _super.prototype.update.call(this, ds, e.key, data.changed[i]);\n            }\n        }\n        if (data.deleted) {\n            for (i = 0; i < data.deleted.length; i++) {\n                _super.prototype.remove.call(this, ds, e.key, data.deleted[i]);\n            }\n        }\n        return data;\n    };\n    /**\n     * Prepare the request body based on the newly added, removed and updated records.\n     * Also perform the changes in the locally cached data to sync with the remote data.\n     * The result is used by the batch request.\n     * @param  {DataManager} dm\n     * @param  {CrudOptions} changes\n     * @param  {RemoteArgs} e\n     */\n    RemoteSaveAdaptor.prototype.batchRequest = function (dm, changes, e, query, original) {\n        return {\n            type: 'POST',\n            url: dm.dataSource.batchUrl || dm.dataSource.crudUrl || dm.dataSource.url,\n            contentType: 'application/json; charset=utf-8',\n            dataType: 'json',\n            data: JSON.stringify(extend({}, {\n                changed: changes.changedRecords,\n                added: changes.addedRecords,\n                deleted: changes.deletedRecords,\n                action: 'batch',\n                table: e.url,\n                key: e.key\n            }, DataUtil.getAddParams(this, dm, query)))\n        };\n    };\n    RemoteSaveAdaptor.prototype.addParams = function (options) {\n        var urlParams = new UrlAdaptor();\n        urlParams.addParams(options);\n    };\n    return RemoteSaveAdaptor;\n}(JsonAdaptor));\nexport { RemoteSaveAdaptor };\n/**\n * Cache Adaptor is used to cache the data of the visited pages. It prevents new requests for the previously visited pages.\n * You can configure cache page size and duration of caching by using cachingPageSize and timeTillExpiration properties of the DataManager\n * @hidden\n */\nvar CacheAdaptor = /** @class */ (function (_super) {\n    __extends(CacheAdaptor, _super);\n    /**\n     * Constructor for CacheAdaptor class.\n     * @param  {CacheAdaptor} adaptor?\n     * @param  {number} timeStamp?\n     * @param  {number} pageSize?\n     * @hidden\n     */\n    function CacheAdaptor(adaptor, timeStamp, pageSize) {\n        var _this = _super.call(this) || this;\n        _this.isCrudAction = false;\n        _this.isInsertAction = false;\n        if (!isNullOrUndefined(adaptor)) {\n            _this.cacheAdaptor = adaptor;\n        }\n        _this.pageSize = pageSize;\n        _this.guidId = DataUtil.getGuid('cacheAdaptor');\n        var obj = { keys: [], results: [] };\n        window.localStorage.setItem(_this.guidId, JSON.stringify(obj));\n        var guid = _this.guidId;\n        if (!isNullOrUndefined(timeStamp)) {\n            setInterval(function () {\n                var data;\n                data = DataUtil.parse.parseJson(window.localStorage.getItem(guid));\n                var forDel = [];\n                for (var i = 0; i < data.results.length; i++) {\n                    var currentTime = +new Date();\n                    var requestTime = +new Date(data.results[i].timeStamp);\n                    data.results[i].timeStamp = currentTime - requestTime;\n                    if (currentTime - requestTime > timeStamp) {\n                        forDel.push(i);\n                    }\n                }\n                for (var i = 0; i < forDel.length; i++) {\n                    data.results.splice(forDel[i], 1);\n                    data.keys.splice(forDel[i], 1);\n                }\n                window.localStorage.removeItem(guid);\n                window.localStorage.setItem(guid, JSON.stringify(data));\n            }, timeStamp);\n        }\n        return _this;\n    }\n    /**\n     * It will generate the key based on the URL when we send a request to server.\n     * @param  {string} url\n     * @param  {Query} query?\n     * @hidden\n     */\n    CacheAdaptor.prototype.generateKey = function (url, query) {\n        var queries = this.getQueryRequest(query);\n        var singles = Query.filterQueryLists(query.queries, ['onSelect', 'onPage', 'onSkip', 'onTake', 'onRange']);\n        var key = url;\n        var page = 'onPage';\n        if (page in singles) {\n            key += singles[page].pageIndex;\n        }\n        queries.sorts.forEach(function (obj) {\n            key += obj.e.direction + obj.e.fieldName;\n        });\n        queries.groups.forEach(function (obj) {\n            key += obj.e.fieldName;\n        });\n        queries.searches.forEach(function (obj) {\n            key += obj.e.searchKey;\n        });\n        for (var filter = 0; filter < queries.filters.length; filter++) {\n            var currentFilter = queries.filters[filter];\n            if (currentFilter.e.isComplex) {\n                var newQuery = query.clone();\n                newQuery.queries = [];\n                for (var i = 0; i < currentFilter.e.predicates.length; i++) {\n                    newQuery.queries.push({ fn: 'onWhere', e: currentFilter.e.predicates[i], filter: query.queries.filter });\n                }\n                key += currentFilter.e.condition + this.generateKey(url, newQuery);\n            }\n            else {\n                key += currentFilter.e.field + currentFilter.e.operator + currentFilter.e.value;\n            }\n        }\n        return key;\n    };\n    /**\n     * Process the query to generate request body.\n     * If the data is already cached, it will return the cached data.\n     * @param  {DataManager} dm\n     * @param  {Query} query?\n     * @param  {Object[]} hierarchyFilters?\n     */\n    CacheAdaptor.prototype.processQuery = function (dm, query, hierarchyFilters) {\n        var key = this.generateKey(dm.dataSource.url, query);\n        var cachedItems;\n        cachedItems = DataUtil.parse.parseJson(window.localStorage.getItem(this.guidId));\n        var data = cachedItems ? cachedItems.results[cachedItems.keys.indexOf(key)] : null;\n        if (data != null && !this.isCrudAction && !this.isInsertAction) {\n            return data;\n        }\n        this.isCrudAction = null;\n        this.isInsertAction = null;\n        return this.cacheAdaptor.processQuery.apply(this.cacheAdaptor, [].slice.call(arguments, 0));\n    };\n    /**\n     * Returns the data from the query processing.\n     * It will also cache the data for later usage.\n     * @param  {DataResult} data\n     * @param  {DataManager} ds?\n     * @param  {Query} query?\n     * @param  {XMLHttpRequest} xhr?\n     * @param  {Ajax} request?\n     * @param  {CrudOptions} changes?\n     */\n    CacheAdaptor.prototype.processResponse = function (data, ds, query, xhr, request, changes) {\n        if (this.isInsertAction || (request && this.cacheAdaptor.options.batch &&\n            DataUtil.endsWith(request.url, this.cacheAdaptor.options.batch) && request.type.toLowerCase() === 'post')) {\n            return this.cacheAdaptor.processResponse(data, ds, query, xhr, request, changes);\n        }\n        data = this.cacheAdaptor.processResponse.apply(this.cacheAdaptor, [].slice.call(arguments, 0));\n        var key = query ? this.generateKey(ds.dataSource.url, query) : ds.dataSource.url;\n        var obj = {};\n        obj = DataUtil.parse.parseJson(window.localStorage.getItem(this.guidId));\n        var index = obj.keys.indexOf(key);\n        if (index !== -1) {\n            obj.results.splice(index, 1);\n            obj.keys.splice(index, 1);\n        }\n        obj.results[obj.keys.push(key) - 1] = { keys: key, result: data.result, timeStamp: new Date(), count: data.count };\n        while (obj.results.length > this.pageSize) {\n            obj.results.splice(0, 1);\n            obj.keys.splice(0, 1);\n        }\n        window.localStorage.setItem(this.guidId, JSON.stringify(obj));\n        return data;\n    };\n    /**\n     * Method will trigger before send the request to server side. Used to set the custom header or modify the request options.\n     * @param  {DataManager} dm\n     * @param  {XMLHttpRequest} request\n     * @param  {Ajax} settings?\n     */\n    CacheAdaptor.prototype.beforeSend = function (dm, request, settings) {\n        if (!isNullOrUndefined(this.cacheAdaptor.options.batch) && DataUtil.endsWith(settings.url, this.cacheAdaptor.options.batch)\n            && settings.type.toLowerCase() === 'post') {\n            request.setRequestHeader('Accept', this.cacheAdaptor.options.multipartAccept);\n        }\n        if (!dm.dataSource.crossDomain) {\n            request.setRequestHeader('Accept', this.cacheAdaptor.options.accept);\n        }\n    };\n    /**\n     * Updates existing record and saves the changes to the table.\n     * @param  {DataManager} dm\n     * @param  {string} keyField\n     * @param  {Object} value\n     * @param  {string} tableName\n     */\n    CacheAdaptor.prototype.update = function (dm, keyField, value, tableName) {\n        this.isCrudAction = true;\n        return this.cacheAdaptor.update(dm, keyField, value, tableName);\n    };\n    /**\n     * Prepare and returns request body which is used to insert a new record in the table.\n     * @param  {DataManager} dm\n     * @param  {Object} data\n     * @param  {string} tableName?\n     */\n    CacheAdaptor.prototype.insert = function (dm, data, tableName) {\n        this.isInsertAction = true;\n        return this.cacheAdaptor.insert(dm, data, tableName);\n    };\n    /**\n     * Prepare and return request body which is used to remove record from the table.\n     * @param  {DataManager} dm\n     * @param  {string} keyField\n     * @param  {Object} value\n     * @param  {string} tableName?\n     */\n    CacheAdaptor.prototype.remove = function (dm, keyField, value, tableName) {\n        this.isCrudAction = true;\n        return this.cacheAdaptor.remove(dm, keyField, value, tableName);\n    };\n    /**\n     * Prepare the request body based on the newly added, removed and updated records.\n     * The result is used by the batch request.\n     * @param  {DataManager} dm\n     * @param  {CrudOptions} changes\n     * @param  {RemoteArgs} e\n     */\n    CacheAdaptor.prototype.batchRequest = function (dm, changes, e) {\n        return this.cacheAdaptor.batchRequest(dm, changes, e);\n    };\n    return CacheAdaptor;\n}(UrlAdaptor));\nexport { CacheAdaptor };\n"]},"metadata":{},"sourceType":"module"}